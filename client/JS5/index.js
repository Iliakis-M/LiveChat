"use strict";function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}var text={shift:!1,area:null,send:null,room:null,user:null},scroll=100,historyIdx=0,hist=[""],maxHistory=50,rooms={},room="LOBBY",last=0,prefix="!!",threshold=800;for(window.has=[],window.nick=getCookie("user")||"guest_"+Math.round(1e5*Math.random());!(nick=prompt("Insert a Nickname:",nick||getCookie("user")))||!/^[a-zA-Z0-9_\-();' ]+$/i.test(nick););function drop(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;for(a=a.split(" ");b--;)a.shift();return a.join(" ")}//drop
function dropGet(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;for(a=a.split(" ");b--;)a.shift();return a.shift()}//dropGet
function load(){return _load.apply(this,arguments)}//load
function _load(){return _load=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:console.log("Index loaded"),text.area=document.getElementById("msgarea"),text.send=document.getElementById("txtarea"),text.room=document.getElementById("rooms"),text.user=document.getElementById("users"),500>=window.innerWidth&&text.room.classList.add("shrink"),auth(nick),setCookie("user",nick),parseQueries(),resize(),Array.from(document.querySelectorAll("script, link, img, audio, iframe")).forEach(function(a){var b=a.src||a.href;b&&window.has.push(b.replace(/^https?:\/{2}.+?\//gmi,""))}),sock.on("message",/*#__PURE__*/function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(b,c,d){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:d==room&&message(b,c);case 1:case"end":return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}()),sock.on("joinable",function(a,b){var c=a;if(a in rooms){var e=rooms[a];return void(e.onclick=function(){switchCur(a,b?void 0:"")})}a.startsWith("USR")&&(c="Private Channel\n (".concat(a,")"));var d=document.createElement("p");d.classList.add("channel"),d.innerHTML=c,d.onclick=function(){switchCur(a,b?void 0:"")},rooms[a]=d,text.room.appendChild(d)}),sock.on("left",function(){}),sock.on("main",function(a){rooms[room].classList.remove("selected-chan"),rooms[a].classList.add("selected-chan"),room=a}),sock.on("history",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){var b,c,d,e,f,g=arguments;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:for(b=g.length,c=Array(b),d=0;d<b;d++)c[d]=g[d];for(e=0;e<c.length;e++)f=c[e],f.room==room&&message(f.content,f.user,new Date(f.timestamp).toDateString());case 2:case"end":return a.stop();}},a,this)}))),sock.once("connect",function(){text.area.innerHTML="",message("This is a Beta version of a chatting service, upcoming features are: profile picture support, multiple chatrooms and more security!","<font color='red'><b>SYSTEM</b></font>"),message("<b>THIS SERVER DOES NOT FOLLOW PRIVACY RULES!! USE AT YOUR OWN AGREEMENT (GDPR)</b>","<font color='red'><b>SYSTEM</b></font>"),message("<u>Please be kind and don't spam, we have means of banning aggitators.</u>","<font color='red'><b>SYSTEM</b></font>"),console.info("The prefix is !!, type !!help in chat for commands.")});case 17:case"end":return a.stop();}},a,this)})),_load.apply(this,arguments)}function parexp(){var a=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(a)return setTimeout(parexp,300,!1);var b=60;return text.room.classList.contains("shrink-r")?(text.area.classList.add("msgarealeft"),b+=20,console.info(text.area.style.left)):text.area.classList.remove("msgarealeft"),text.user.classList.contains("shrink-l")&&(b+=20),text.area.style.width=b+"%"}//parexp
function alrel(a){return alrel=function(){},alert(a),location.reload()}//alrel
function switchCur(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"LOBBY",b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:prompt("Password (Leave empty for public rooms or already authorized rooms)",""),c=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return sock.emit("switch",a,b,c),text.area.innerHTML=""}//switchCur
function send(){var msg=0<arguments.length&&void 0!==arguments[0]?arguments[0]:text.send.value;return(text.send.value="",msg.startsWith(prefix))?command(msg):(msg=msg.replace(/\${((.|\n)+?)}/gm,function(match,p){return eval(p)}),msg=msg.trim(),sendMessage(msg))}//send
function sendMessage(a){return a?Date.now()-last<=threshold?message("<font color='red'><b>Please wait ".concat(threshold/1e3,"s before sending another message!</b></font>"),"<font color='red'><b>SYSTEM</b></font>"):conn?(sock.send(a),last=Date.now()):message("<font color='red'><b>You cannot send messages while disconnected!</b></font>","<font color='red'><b>SYSTEM</b></font>"):message("<font color='red'><b>You cannot send an empty message!</b></font>","<font color='red'><b>SYSTEM</b></font>")}//sendMessage
function message(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Date().toDateString(),d=document.createElement("p");return d.innerHTML="<font color='gray'><small>".concat(c,"</small></font>&emsp;<b>").concat(b,":</b> ").concat(a,"<hr />"),text.area.appendChild(d),text.area.scrollBy?text.area.scrollBy(0,scroll):text.area.scrollTop+=scroll}//message
function shiftcheck(a){var b=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];if("Shift"==a.key)text.shift=b;else{if("ArrowUp"==a.key&&b)return++historyIdx,historyIdx%=hist.length,text.send.value=hist[historyIdx];if("ArrowUp"==a.key)return;if("ArrowDown"==a.key&&b)return historyIdx=1>historyIdx?hist.length-1:historyIdx-1,text.send.value=hist[historyIdx];if("ArrowDown"==a.key)return;if("Enter"==a.key&&!text.shift&&!b)for(send(),hist.unshift("");hist.length>=maxHistory;)hist.pop()}return hist[0]=text.send.value}//shiftcheck
function submit(){return text.shift=!1,shiftcheck({key:"Enter"},!1)}//submit
function sanitize(a){return a=a.replace(/&/gmi,"&amp;").replace(/</gmi,"&lt;").replace(/>/gmi,"&gt;").replace(/"/gmi,"&quot;").replace(/'/gmi,"&#039;"),a}//sanitize
function parseCookies(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:document.cookie;return new Map(a.split(";").map(function(a){return a.split("=")}))}//parseCookies
function storeCookies(a){return document.cookie=Array.from(a).map(function(b){return b.join("=")}).join(";")}//storeCookies
function setCookie(a,b){var c=parseCookies();return c.set(a,b),storeCookies(c)}//setCookie
function getCookie(a){var b=parseCookies();return b.get(a)}//getCookie
function parseQueries(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:location.href,b=a.split("?").pop().replace(/#.*?$/,"").split("&").map(function(a){return a.split("=")}),c=!0,d=!1,e=void 0;try{for(var f,g,h=b[Symbol.iterator]();!(c=(f=h.next()).done);c=!0)g=f.value,window[g.shift()]=g.pop()}catch(a){d=!0,e=a}finally{try{c||null==h.return||h.return()}finally{if(d)throw e}}}//parseQueries
window.addEventListener("DOMContentLoaded",load),window.addEventListener("resize",window.resize=function(){var a=document.getElementsByClassName("xpand");a[1].style.left=document.getElementById("ui-wrapper").offsetWidth-a[1].offsetWidth-a[0].offsetLeft+"px"});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL0pTL2luZGV4LmpzIl0sIm5hbWVzIjpbInRleHQiLCJzaGlmdCIsImFyZWEiLCJzZW5kIiwicm9vbSIsInVzZXIiLCJzY3JvbGwiLCJoaXN0b3J5SWR4IiwiaGlzdCIsIm1heEhpc3RvcnkiLCJyb29tcyIsImxhc3QiLCJwcmVmaXgiLCJ0aHJlc2hvbGQiLCJ3aW5kb3ciLCJoYXMiLCJuaWNrIiwiZ2V0Q29va2llIiwiTWF0aCIsInJvdW5kIiwicmFuZG9tIiwicHJvbXB0IiwidGVzdCIsImRyb3AiLCJsaW5lIiwidCIsInNwbGl0Iiwiam9pbiIsImRyb3BHZXQiLCJsb2FkIiwiY29uc29sZSIsImxvZyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJpbm5lcldpZHRoIiwiY2xhc3NMaXN0IiwiYWRkIiwiYXV0aCIsInNldENvb2tpZSIsInBhcnNlUXVlcmllcyIsInJlc2l6ZSIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZWwiLCJhcHAiLCJzcmMiLCJocmVmIiwicHVzaCIsInJlcGxhY2UiLCJzb2NrIiwib24iLCJtc2ciLCJybSIsIm1lc3NhZ2UiLCJjaGFuIiwicGFzcyIsImNoYW5uIiwicCIsIm9uY2xpY2siLCJzd2l0Y2hDdXIiLCJzdGFydHNXaXRoIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsImFwcGVuZENoaWxkIiwibmFtZSIsInJlbW92ZSIsImRhdGEiLCJpIiwiY29udGVudCIsIkRhdGUiLCJ0aW1lc3RhbXAiLCJ0b0RhdGVTdHJpbmciLCJvbmNlIiwiaW5mbyIsInBhcmV4cCIsImRlbCIsInNldFRpbWVvdXQiLCJleHAiLCJjb250YWlucyIsInN0eWxlIiwibGVmdCIsIndpZHRoIiwiYWxyZWwiLCJhbGVydCIsImxvY2F0aW9uIiwicmVsb2FkIiwidmlzaWJsZSIsImVtaXQiLCJ2YWx1ZSIsImNvbW1hbmQiLCJtYXRjaCIsImV2YWwiLCJ0cmltIiwic2VuZE1lc3NhZ2UiLCJub3ciLCJjb25uIiwiZGF0ZSIsInNjcm9sbEJ5Iiwic2Nyb2xsVG9wIiwic2hpZnRjaGVjayIsImV2ZW50IiwiZG93biIsImtleSIsImxlbmd0aCIsInVuc2hpZnQiLCJwb3AiLCJzdWJtaXQiLCJzYW5pdGl6ZSIsInBhcnNlQ29va2llcyIsImNvb2tpZXMiLCJjb29raWUiLCJNYXAiLCJtYXAiLCJjIiwic3RvcmVDb29raWVzIiwiYSIsInRtcCIsInNldCIsImdldCIsImxvYyIsIm91dCIsInEiLCJhZGRFdmVudExpc3RlbmVyIiwieHAiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwib2Zmc2V0V2lkdGgiLCJvZmZzZXRMZWZ0Il0sIm1hcHBpbmdzIjoiQUFBQyxhLGdZQUVHQSxDQUFBQSxJQUFZLENBQUcsQ0FDbEJDLEtBQUssR0FEYSxDQUVsQkMsSUFBSSxDQUFFLElBRlksQ0FHbEJDLElBQUksQ0FBRSxJQUhZLENBSWxCQyxJQUFJLENBQUUsSUFKWSxDQUtsQkMsSUFBSSxDQUFFLElBTFksQyxDQU9sQkMsTUFBYyxDQUFHLEcsQ0FDakJDLFVBQWtCLENBQUcsQyxDQUNyQkMsSUFBVyxDQUFHLENBQUMsRUFBRCxDLENBQ2RDLFVBQWtCLENBQUcsRSxDQUNyQkMsS0FBYSxDQUFHLEUsQ0FDaEJOLElBQVksQ0FBRyxPLENBQ2ZPLElBQUksQ0FBRyxDLENBRUZDLE1BQWMsQ0FBRyxJLENBQ3RCQyxTQUFTLENBQUcsRyxLQUViQyxNQUFNLENBQUNDLEdBQVAsQ0FBYSxFLENBRWJELE1BQU0sQ0FBQ0UsSUFBUCxDQUFjQyxTQUFTLENBQUMsTUFBRCxDQUFULEVBQXFCLFNBQVdDLElBQUksQ0FBQ0MsS0FBTCxDQUEyQixHQUFoQixDQUFBRCxJQUFJLENBQUNFLE1BQUwsRUFBWCxDLENBRXZDLEVBQUVKLElBQUksQ0FBR0ssTUFBTSxDQUFDLG9CQUFELENBQXVCTCxJQUFJLEVBQUlDLFNBQVMsQ0FBQyxNQUFELENBQXhDLENBQWYsR0FBcUUsQ0FBQywwQkFBMEJLLElBQTFCLENBQStCTixJQUEvQixDLEdBRTdFLFFBQVNPLENBQUFBLElBQVQsQ0FBY0MsQ0FBZCxDQUFtRCxJQUF2QkMsQ0FBQUEsQ0FBdUIsd0RBQVgsQ0FBVyxLQUNsREQsQ0FBSSxDQUFHQSxDQUFJLENBQUNFLEtBQUwsQ0FBVyxHQUFYLENBRDJDLENBRTNDRCxDQUFDLEVBRjBDLEVBR2pERCxDQUFJLENBQUN2QixLQUFMLEdBRUQsTUFBT3VCLENBQUFBLENBQUksQ0FBQ0csSUFBTCxDQUFVLEdBQVYsQ0FDUCxDQUFDO0FBRUYsUUFBU0MsQ0FBQUEsT0FBVCxDQUFpQkosQ0FBakIsQ0FBc0QsSUFBdkJDLENBQUFBLENBQXVCLHdEQUFYLENBQVcsS0FDckRELENBQUksQ0FBR0EsQ0FBSSxDQUFDRSxLQUFMLENBQVcsR0FBWCxDQUQ4QyxDQUU5Q0QsQ0FBQyxFQUY2QyxFQUdwREQsQ0FBSSxDQUFDdkIsS0FBTCxHQUVELE1BQU91QixDQUFBQSxDQUFJLENBQUN2QixLQUFMLEVBQ1AsQ0FBQztRQUVhNEIsQ0FBQUEsSSxzQ0FtRWI7cUZBbkVGLDRGQUNDQyxPQUFPLENBQUNDLEdBQVIsQ0FBWSxjQUFaLENBREQsQ0FHQy9CLElBQUksQ0FBQ0UsSUFBTCxDQUFZOEIsUUFBUSxDQUFDQyxjQUFULENBQXdCLFNBQXhCLENBSGIsQ0FJQ2pDLElBQUksQ0FBQ0csSUFBTCxDQUFZNkIsUUFBUSxDQUFDQyxjQUFULENBQXdCLFNBQXhCLENBSmIsQ0FLQ2pDLElBQUksQ0FBQ0ksSUFBTCxDQUFZNEIsUUFBUSxDQUFDQyxjQUFULENBQXdCLE9BQXhCLENBTGIsQ0FNQ2pDLElBQUksQ0FBQ0ssSUFBTCxDQUFZMkIsUUFBUSxDQUFDQyxjQUFULENBQXdCLE9BQXhCLENBTmIsQ0FRMEIsR0FBckIsRUFBQW5CLE1BQU0sQ0FBQ29CLFVBUlosRUFTRWxDLElBQUksQ0FBQ0ksSUFBTCxDQUFVK0IsU0FBVixDQUFvQkMsR0FBcEIsQ0FBd0IsUUFBeEIsQ0FURixDQVlDQyxJQUFJLENBQUNyQixJQUFELENBWkwsQ0FhQ3NCLFNBQVMsQ0FBQyxNQUFELENBQVN0QixJQUFULENBYlYsQ0FjQ3VCLFlBQVksRUFkYixDQWVDQyxNQUFNLEVBZlAsQ0FpQkNDLEtBQUssQ0FBQ0MsSUFBTixDQUFXVixRQUFRLENBQUNXLGdCQUFULENBQTBCLGtDQUExQixDQUFYLEVBQTBFQyxPQUExRSxDQUFrRixTQUFBQyxDQUFFLENBQUksQ0FDdkYsR0FBSUMsQ0FBQUEsQ0FBRyxDQUFHRCxDQUFFLENBQUNFLEdBQUgsRUFBVUYsQ0FBRSxDQUFDRyxJQUF2QixDQUVJRixDQUhtRixFQUl0RmhDLE1BQU0sQ0FBQ0MsR0FBUCxDQUFXa0MsSUFBWCxDQUFnQkgsQ0FBRyxDQUFDSSxPQUFKLENBQVksdUJBQVosQ0FBcUMsRUFBckMsQ0FBaEIsQ0FFRCxDQU5ELENBakJELENBeUJDQyxJQUFJLENBQUNDLEVBQUwsQ0FBUSxTQUFSLHNGQUFtQixXQUFPQyxDQUFQLENBQW9CckMsQ0FBcEIsQ0FBa0NzQyxDQUFsQyxpRkFDZEEsQ0FBRSxFQUFJbEQsSUFEUSxFQUNGbUQsT0FBTyxDQUFDRixDQUFELENBQU1yQyxDQUFOLENBREwsNkNBQW5CLHdEQXpCRCxDQTRCQ21DLElBQUksQ0FBQ0MsRUFBTCxDQUFRLFVBQVIsQ0FBb0IsU0FBQ0ksQ0FBRCxDQUFPQyxDQUFQLENBQWdCLENBQ25DLEdBQUlDLENBQUFBLENBQUssQ0FBR0YsQ0FBWixDQUNBLEdBQUlBLENBQUksR0FBSTlDLENBQUFBLEtBQVosQ0FBbUIsQ0FDbEIsR0FBSWlELENBQUFBLENBQUMsQ0FBR2pELEtBQUssQ0FBQzhDLENBQUQsQ0FBYixDQUlBLFlBSEFHLENBQUMsQ0FBQ0MsT0FBRixDQUFZLFVBQTJCLENBQ3RDQyxTQUFTLENBQUNMLENBQUQsQ0FBT0MsQ0FBSSxRQUFlLEVBQTFCLENBQ1QsQ0FDRCxDQUNBLENBQ0dELENBQUksQ0FBQ00sVUFBTCxDQUFnQixLQUFoQixDQVQrQixHQVVsQ0osQ0FBSyw4QkFBeUJGLENBQXpCLEtBVjZCLEVBWW5DLEdBQUlHLENBQUFBLENBQUMsQ0FBRzNCLFFBQVEsQ0FBQytCLGFBQVQsQ0FBdUIsR0FBdkIsQ0FBUixDQUNBSixDQUFDLENBQUN4QixTQUFGLENBQVlDLEdBQVosQ0FBZ0IsU0FBaEIsQ0FibUMsQ0FjbkN1QixDQUFDLENBQUNLLFNBQUYsQ0FBY04sQ0FkcUIsQ0FlbkNDLENBQUMsQ0FBQ0MsT0FBRixDQUFZLFVBQTJCLENBQ3RDQyxTQUFTLENBQUNMLENBQUQsQ0FBT0MsQ0FBSSxRQUFlLEVBQTFCLENBQ1QsQ0FqQmtDLENBa0JuQy9DLEtBQUssQ0FBQzhDLENBQUQsQ0FBTCxDQUFjRyxDQWxCcUIsQ0FtQm5DM0QsSUFBSSxDQUFDSSxJQUFMLENBQVU2RCxXQUFWLENBQXNCTixDQUF0QixDQUNBLENBcEJELENBNUJELENBaURDUixJQUFJLENBQUNDLEVBQUwsQ0FBUSxNQUFSLENBQWdCLFVBQU0sQ0FBRyxDQUF6QixDQWpERCxDQWtEQ0QsSUFBSSxDQUFDQyxFQUFMLENBQVEsTUFBUixDQUFnQixTQUFBYyxDQUFJLENBQUksQ0FDdkJ4RCxLQUFLLENBQUNOLElBQUQsQ0FBTCxDQUFZK0IsU0FBWixDQUFzQmdDLE1BQXRCLENBQTZCLGVBQTdCLENBRHVCLENBRXZCekQsS0FBSyxDQUFDd0QsQ0FBRCxDQUFMLENBQVkvQixTQUFaLENBQXNCQyxHQUF0QixDQUEwQixlQUExQixDQUZ1QixDQUd2QmhDLElBQUksQ0FBRzhELENBQ1AsQ0FKRCxDQWxERCxDQXVEQ2YsSUFBSSxDQUFDQyxFQUFMLENBQVEsU0FBUixxRUFBbUIscUlBQVVnQixDQUFWLHNCQUFVQSxDQUFWLFNBQ2xCLFVBQWNBLENBQWQsWUFBU0MsQ0FBVCxDQUFjRCxDQUFkLElBQ0tDLENBQUMsQ0FBQ2pFLElBQUYsRUFBVUEsSUFEZixFQUNxQm1ELE9BQU8sQ0FBQ2MsQ0FBQyxDQUFDQyxPQUFILENBQVlELENBQUMsQ0FBQ2hFLElBQWQsQ0FBcUIsR0FBSWtFLENBQUFBLElBQUosQ0FBU0YsQ0FBQyxDQUFDRyxTQUFYLENBQUQsQ0FBd0JDLFlBQXhCLEVBQXBCLENBRDVCLENBRGtCLDRDQUFuQixHQXZERCxDQTREQ3RCLElBQUksQ0FBQ3VCLElBQUwsQ0FBVSxTQUFWLENBQXFCLFVBQVksQ0FDaEMxRSxJQUFJLENBQUNFLElBQUwsQ0FBVThELFNBQVYsQ0FBc0IsRUFEVSxDQUVoQ1QsT0FBTyxDQUFDLHFJQUFELENBQXdJLHdDQUF4SSxDQUZ5QixDQUdoQ0EsT0FBTyxDQUFDLHFGQUFELENBQXdGLHdDQUF4RixDQUh5QixDQUloQ0EsT0FBTyxDQUFDLDRFQUFELENBQStFLHdDQUEvRSxDQUp5QixDQUtoQ3pCLE9BQU8sQ0FBQzZDLElBQVIsQ0FBYSxxREFBYixDQUNBLENBTkQsQ0E1REQsOEMsK0JBcUVBLFFBQVNDLENBQUFBLE1BQVQsRUFBNEIsSUFBWkMsQ0FBQUEsQ0FBWSw0REFDM0IsR0FBSUEsQ0FBSixDQUNDLE1BQU9DLENBQUFBLFVBQVUsQ0FBQ0YsTUFBRCxDQUFTLEdBQVQsSUFBakIsQ0FFRCxHQUFJRyxDQUFBQSxDQUFHLENBQUcsRUFBVixDQVdBLE1BVkkvRSxDQUFBQSxJQUFJLENBQUNJLElBQUwsQ0FBVStCLFNBQVYsQ0FBb0I2QyxRQUFwQixDQUE2QixVQUE3QixDQVVKLEVBVENoRixJQUFJLENBQUNFLElBQUwsQ0FBVWlDLFNBQVYsQ0FBb0JDLEdBQXBCLENBQXdCLGFBQXhCLENBU0QsQ0FSQzJDLENBQUcsRUFBSSxFQVFSLENBUENqRCxPQUFPLENBQUM2QyxJQUFSLENBQWEzRSxJQUFJLENBQUNFLElBQUwsQ0FBVStFLEtBQVYsQ0FBZ0JDLElBQTdCLENBT0QsRUFMQ2xGLElBQUksQ0FBQ0UsSUFBTCxDQUFVaUMsU0FBVixDQUFvQmdDLE1BQXBCLENBQTJCLGFBQTNCLENBS0QsQ0FISW5FLElBQUksQ0FBQ0ssSUFBTCxDQUFVOEIsU0FBVixDQUFvQjZDLFFBQXBCLENBQTZCLFVBQTdCLENBR0osR0FGQ0QsQ0FBRyxFQUFJLEVBRVIsRUFBTy9FLElBQUksQ0FBQ0UsSUFBTCxDQUFVK0UsS0FBVixDQUFnQkUsS0FBaEIsQ0FBd0JKLENBQUcsQ0FBRyxHQUNyQyxDQUFDO0FBRUYsUUFBU0ssQ0FBQUEsS0FBVCxDQUFlcEYsQ0FBZixDQUFxQixDQUdwQixNQUZBb0YsQ0FBQUEsS0FBSyxDQUFHLFVBQU0sQ0FBRyxDQUVqQixDQURBQyxLQUFLLENBQUNyRixDQUFELENBQ0wsQ0FBT3NGLFFBQVEsQ0FBQ0MsTUFBVCxFQUNQLENBQUM7QUFFRixRQUFTMUIsQ0FBQUEsU0FBVCxFQUFzSyxJQUFuSkssQ0FBQUEsQ0FBbUosd0RBQXBJLE9BQW9JLENBQTNIVCxDQUEySCx3REFBNUdwQyxNQUFNLENBQUMscUVBQUQsQ0FBd0UsRUFBeEUsQ0FBc0csQ0FBekJtRSxDQUF5Qiw0REFFckssTUFEQXJDLENBQUFBLElBQUksQ0FBQ3NDLElBQUwsQ0FBVSxRQUFWLENBQW9CdkIsQ0FBcEIsQ0FBMEJULENBQTFCLENBQWdDK0IsQ0FBaEMsQ0FDQSxDQUFPeEYsSUFBSSxDQUFDRSxJQUFMLENBQVU4RCxTQUFWLENBQXNCLEVBQzdCLENBQUM7QUFFRixRQUFTN0QsQ0FBQUEsSUFBVCxFQUFtRCxJQUFyQ2tELENBQUFBLEdBQXFDLHdEQUF2QnJELElBQUksQ0FBQ0csSUFBTCxDQUFVdUYsS0FBYSxRQUNsRDFGLElBQUksQ0FBQ0csSUFBTCxDQUFVdUYsS0FBVixDQUFrQixFQURnQyxDQUU5Q3JDLEdBQUcsQ0FBQ1MsVUFBSixDQUFlbEQsTUFBZixDQUY4QyxFQUcxQytFLE9BQU8sQ0FBQ3RDLEdBQUQsQ0FIbUMsRUFLbERBLEdBQUcsQ0FBR0EsR0FBRyxDQUFDSCxPQUFKLENBQVksa0JBQVosQ0FBZ0MsU0FBQzBDLEtBQUQsQ0FBUWpDLENBQVIsUUFBY2tDLENBQUFBLElBQUksQ0FBQ2xDLENBQUQsQ0FBbEIsQ0FBaEMsQ0FMNEMsQ0FNbEROLEdBQUcsQ0FBR0EsR0FBRyxDQUFDeUMsSUFBSixFQU40QyxDQU8zQ0MsV0FBVyxDQUFDMUMsR0FBRCxDQVBnQyxDQVFsRCxDQUFDO0FBRUYsUUFBUzBDLENBQUFBLFdBQVQsQ0FBcUIxQyxDQUFyQixDQUF3QyxPQUNsQ0EsQ0FBQUEsQ0FEa0MsQ0FHNUJrQixJQUFJLENBQUN5QixHQUFMLEdBQWFyRixJQUFiLEVBQXFCRSxTQUhPLENBSS9CMEMsT0FBTyw0Q0FBcUMxQyxTQUFTLENBQUcsR0FBakQsaURBQXFHLHdDQUFyRyxDQUp3QixDQUs1Qm9GLElBTDRCLEVBTXRDOUMsSUFBSSxDQUFDaEQsSUFBTCxDQUFVa0QsQ0FBVixDQU5zQyxDQU8vQjFDLElBQUksQ0FBRzRELElBQUksQ0FBQ3lCLEdBQUwsRUFQd0IsRUFTL0J6QyxPQUFPLENBQUMsOEVBQUQsQ0FBaUYsd0NBQWpGLENBVHdCLENBRS9CQSxPQUFPLENBQUMsbUVBQUQsQ0FBc0Usd0NBQXRFLENBU2YsQ0FBQztBQUVGLFFBQVNBLENBQUFBLE9BQVQsQ0FBaUJGLENBQWpCLENBQThCaEQsQ0FBOUIsQ0FBOEYsSUFBbEQ2RixDQUFBQSxDQUFrRCx3REFBbEMsR0FBSTNCLENBQUFBLElBQUosRUFBRCxDQUFhRSxZQUFiLEVBQW1DLENBQ3pGZCxDQUFDLENBQUczQixRQUFRLENBQUMrQixhQUFULENBQXVCLEdBQXZCLENBRHFGLE9BRTdGSixDQUFBQSxDQUFDLENBQUNLLFNBQUYscUNBQTJDa0MsQ0FBM0Msb0NBQTBFN0YsQ0FBMUUsa0JBQXVGZ0QsQ0FBdkYsVUFGNkYsQ0FJN0ZyRCxJQUFJLENBQUNFLElBQUwsQ0FBVStELFdBQVYsQ0FBc0JOLENBQXRCLENBSjZGLENBS3pGM0QsSUFBSSxDQUFDRSxJQUFMLENBQVVpRyxRQUwrRSxDQU1yRm5HLElBQUksQ0FBQ0UsSUFBTCxDQUFVaUcsUUFBVixDQUFtQixDQUFuQixDQUFzQjdGLE1BQXRCLENBTnFGLENBUXJGTixJQUFJLENBQUNFLElBQUwsQ0FBVWtHLFNBQVYsRUFBdUI5RixNQUUvQixDQUFDO0FBRUYsUUFBUytGLENBQUFBLFVBQVQsQ0FBb0JDLENBQXBCLENBQStELElBQTVCQyxDQUFBQSxDQUE0Qiw0REFDOUQsR0FBaUIsT0FBYixFQUFBRCxDQUFLLENBQUNFLEdBQVYsQ0FDQ3hHLElBQUksQ0FBQ0MsS0FBTCxDQUFhc0csQ0FEZCxNQUVPLEdBQWlCLFNBQWIsRUFBQUQsQ0FBSyxDQUFDRSxHQUFOLEVBQTBCRCxDQUE5QixDQUdOLE1BRkEsRUFBRWhHLFVBRUYsQ0FEQUEsVUFBVSxFQUFJQyxJQUFJLENBQUNpRyxNQUNuQixDQUFPekcsSUFBSSxDQUFDRyxJQUFMLENBQVV1RixLQUFWLENBQWtCbEYsSUFBSSxDQUFDRCxVQUFELENBQTdCLENBQ00sR0FBaUIsU0FBYixFQUFBK0YsQ0FBSyxDQUFDRSxHQUFWLENBQ04sT0FDTSxHQUFpQixXQUFiLEVBQUFGLENBQUssQ0FBQ0UsR0FBTixFQUE0QkQsQ0FBaEMsQ0FFTixNQURBaEcsQ0FBQUEsVUFBVSxDQUFpQixDQUFiLENBQUFBLFVBQUQsQ0FBb0JDLElBQUksQ0FBQ2lHLE1BQUwsQ0FBYyxDQUFsQyxDQUF3Q2xHLFVBQVUsQ0FBRyxDQUNsRSxDQUFPUCxJQUFJLENBQUNHLElBQUwsQ0FBVXVGLEtBQVYsQ0FBa0JsRixJQUFJLENBQUNELFVBQUQsQ0FBN0IsQ0FDTSxHQUFpQixXQUFiLEVBQUErRixDQUFLLENBQUNFLEdBQVYsQ0FDTixPQUNNLEdBQWlCLE9BQWIsRUFBQUYsQ0FBSyxDQUFDRSxHQUFOLEVBQXdCLENBQUN4RyxJQUFJLENBQUNDLEtBQTlCLEVBQXVDLENBQUNzRyxDQUE1QyxLQUNOcEcsSUFBSSxFQURFLENBRU5LLElBQUksQ0FBQ2tHLE9BQUwsQ0FBYSxFQUFiLENBRk0sQ0FHQ2xHLElBQUksQ0FBQ2lHLE1BQUwsRUFBZWhHLFVBSGhCLEVBSUxELElBQUksQ0FBQ21HLEdBQUwsRUFqQkYsQ0FvQkEsTUFBT25HLENBQUFBLElBQUksQ0FBQyxDQUFELENBQUosQ0FBVVIsSUFBSSxDQUFDRyxJQUFMLENBQVV1RixLQUMzQixDQUFDO0FBRUYsUUFBU2tCLENBQUFBLE1BQVQsRUFBa0MsQ0FFakMsTUFEQTVHLENBQUFBLElBQUksQ0FBQ0MsS0FBTCxHQUNBLENBQU9vRyxVQUFVLENBQUMsQ0FDakJHLEdBQUcsQ0FBRSxPQURZLENBQUQsSUFHakIsQ0FBQztBQUVGLFFBQVNLLENBQUFBLFFBQVQsQ0FBa0J4RCxDQUFsQixDQUF1QyxDQU10QyxNQUxBQSxDQUFBQSxDQUFHLENBQUdBLENBQUcsQ0FBQ0gsT0FBSixDQUFZLE1BQVosQ0FBb0IsT0FBcEIsRUFDSkEsT0FESSxDQUNJLE1BREosQ0FDWSxNQURaLEVBRUpBLE9BRkksQ0FFSSxNQUZKLENBRVksTUFGWixFQUdKQSxPQUhJLENBR0ksTUFISixDQUdZLFFBSFosRUFJSkEsT0FKSSxDQUlJLE1BSkosQ0FJWSxRQUpaLENBS04sQ0FBT0csQ0FDUCxDQUFDO0FBRUYsUUFBU3lELENBQUFBLFlBQVQsRUFBOEQsSUFBeENDLENBQUFBLENBQXdDLHdEQUF0Qi9FLFFBQVEsQ0FBQ2dGLE1BQWEsQ0FDN0QsTUFBTyxJQUFJQyxDQUFBQSxHQUFKLENBQVFGLENBQU8sQ0FBQ3JGLEtBQVIsQ0FBYyxHQUFkLEVBQW1Cd0YsR0FBbkIsQ0FBdUIsU0FBQUMsQ0FBQyxRQUFJQSxDQUFBQSxDQUFDLENBQUN6RixLQUFGLENBQVEsR0FBUixDQUFKLENBQXhCLENBQVIsQ0FDUCxDQUFDO0FBRUYsUUFBUzBGLENBQUFBLFlBQVQsQ0FBc0JGLENBQXRCLENBQXdDLENBQ3ZDLE1BQU9sRixDQUFBQSxRQUFRLENBQUNnRixNQUFULENBQWtCdkUsS0FBSyxDQUFDQyxJQUFOLENBQVd3RSxDQUFYLEVBQWdCQSxHQUFoQixDQUFvQixTQUFBRyxDQUFDLFFBQUlBLENBQUFBLENBQUMsQ0FBQzFGLElBQUYsQ0FBTyxHQUFQLENBQUosQ0FBckIsRUFBc0NBLElBQXRDLENBQTJDLEdBQTNDLENBQ3pCLENBQUM7QUFFRixRQUFTVyxDQUFBQSxTQUFULENBQW1Ca0UsQ0FBbkIsQ0FBZ0NkLENBQWhDLENBQXVELENBQ3RELEdBQUk0QixDQUFBQSxDQUFHLENBQUdSLFlBQVksRUFBdEIsQ0FFQSxNQURBUSxDQUFBQSxDQUFHLENBQUNDLEdBQUosQ0FBUWYsQ0FBUixDQUFhZCxDQUFiLENBQ0EsQ0FBTzBCLFlBQVksQ0FBQ0UsQ0FBRCxDQUNuQixDQUFDO0FBRUYsUUFBU3JHLENBQUFBLFNBQVQsQ0FBbUJ1RixDQUFuQixDQUF3QyxDQUN2QyxHQUFJYyxDQUFBQSxDQUFRLENBQUdSLFlBQVksRUFBM0IsQ0FDQSxNQUFPUSxDQUFBQSxDQUFHLENBQUNFLEdBQUosQ0FBUWhCLENBQVIsQ0FDUCxDQUFDO0FBRUYsUUFBU2pFLENBQUFBLFlBQVQsRUFBbUQsSUFBN0JrRixDQUFBQSxDQUE2Qix3REFBZm5DLFFBQVEsQ0FBQ3RDLElBQU0sQ0FDOUMwRSxDQUFHLENBQUdELENBQUcsQ0FBQy9GLEtBQUosQ0FBVSxHQUFWLEVBQWVpRixHQUFmLEdBQXFCekQsT0FBckIsQ0FBNkIsT0FBN0IsQ0FBc0MsRUFBdEMsRUFBMEN4QixLQUExQyxDQUFnRCxHQUFoRCxFQUFxRHdGLEdBQXJELENBQXlELFNBQUFTLENBQUMsUUFBSUEsQ0FBQUEsQ0FBQyxDQUFDakcsS0FBRixDQUFRLEdBQVIsQ0FBSixDQUExRCxDQUR3Qyx3QkFHbEQsVUFBUzJDLENBQVQsR0FBY3FELENBQWQsZ0RBQVNyRCxDQUFULFNBQ0N2RCxNQUFNLENBQUN1RCxDQUFDLENBQUNwRSxLQUFGLEVBQUQsQ0FBTixDQUFvQm9FLENBQUMsQ0FBQ3NDLEdBQUYsRUFKNkIsbUZBTWxELENBQUM7QUFFRjdGLE1BQU0sQ0FBQzhHLGdCQUFQLENBQXdCLGtCQUF4QixDQUE0Qy9GLElBQTVDLEMsQ0FDQWYsTUFBTSxDQUFDOEcsZ0JBQVAsQ0FBd0IsUUFBeEIsQ0FBa0M5RyxNQUFNLENBQUMwQixNQUFQLENBQWdCLFVBQW1CLENBQ3BFLEdBQUlxRixDQUFBQSxDQUFFLENBQUc3RixRQUFRLENBQUM4RixzQkFBVCxDQUFnQyxPQUFoQyxDQUFULENBQ0FELENBQUUsQ0FBQyxDQUFELENBQUYsQ0FBTTVDLEtBQU4sQ0FBWUMsSUFBWixDQUFvQmxELFFBQVEsQ0FBQ0MsY0FBVCxDQUF3QixZQUF4QixFQUFzQzhGLFdBQXRDLENBQW9ERixDQUFFLENBQUMsQ0FBRCxDQUFGLENBQU1FLFdBQTFELENBQXdFRixDQUFFLENBQUMsQ0FBRCxDQUFGLENBQU1HLFVBQS9FLENBQTZGLElBQ2hILENBSEQsQyIsInNvdXJjZXNDb250ZW50IjpbIu+7v1widXNlIHN0cmljdFwiO1xyXG5cclxubGV0IHRleHQ6IG9iamVjdCA9IHtcclxuXHRzaGlmdDogZmFsc2UsXHJcblx0YXJlYTogbnVsbCxcclxuXHRzZW5kOiBudWxsLFxyXG5cdHJvb206IG51bGwsXHJcblx0dXNlcjogbnVsbFxyXG59LFxyXG5cdHNjcm9sbDogbnVtYmVyID0gMTAwLFxyXG5cdGhpc3RvcnlJZHg6IG51bWJlciA9IDAsXHJcblx0aGlzdDogQXJyYXkgPSBbJyddLFxyXG5cdG1heEhpc3Rvcnk6IG51bWJlciA9IDUwLFxyXG5cdHJvb21zOiBvYmplY3QgPSB7IH0sXHJcblx0cm9vbTogc3RyaW5nID0gXCJMT0JCWVwiLFxyXG5cdGxhc3QgPSAwO1xyXG5cclxuY29uc3QgcHJlZml4OiBzdHJpbmcgPSBcIiEhXCIsXHJcblx0dGhyZXNob2xkID0gODAwO1xyXG5cclxud2luZG93LmhhcyA9IFsgXTtcclxuXHJcbndpbmRvdy5uaWNrID0gZ2V0Q29va2llKFwidXNlclwiKSB8fCBcImd1ZXN0X1wiICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMWU1KTtcclxuXHJcbndoaWxlICghKG5pY2sgPSBwcm9tcHQoXCJJbnNlcnQgYSBOaWNrbmFtZTpcIiwgbmljayB8fCBnZXRDb29raWUoXCJ1c2VyXCIpKSkgfHwgIS9eW2EtekEtWjAtOV9cXC0oKTsnIF0rJC9pLnRlc3QobmljaykpIHsgfVxyXG5cclxuZnVuY3Rpb24gZHJvcChsaW5lOiBudW1iZXIsIHQ6IG51bWJlciA9IDEpOiBzdHJpbmcge1xyXG5cdGxpbmUgPSBsaW5lLnNwbGl0KCcgJyk7XHJcblx0d2hpbGUgKHQtLSkge1xyXG5cdFx0bGluZS5zaGlmdCgpO1xyXG5cdH1cclxuXHRyZXR1cm4gbGluZS5qb2luKCcgJyk7XHJcbn0gLy9kcm9wXHJcblxyXG5mdW5jdGlvbiBkcm9wR2V0KGxpbmU6IG51bWJlciwgdDogbnVtYmVyID0gMCk6IHN0cmluZyB7XHJcblx0bGluZSA9IGxpbmUuc3BsaXQoJyAnKTtcclxuXHR3aGlsZSAodC0tKSB7XHJcblx0XHRsaW5lLnNoaWZ0KCk7XHJcblx0fVxyXG5cdHJldHVybiBsaW5lLnNoaWZ0KCk7XHJcbn0gLy9kcm9wR2V0XHJcblxyXG5hc3luYyBmdW5jdGlvbiBsb2FkKGU/OiBvYmplY3QpOiB2b2lkIHtcclxuXHRjb25zb2xlLmxvZyhcIkluZGV4IGxvYWRlZFwiKTtcclxuXHJcblx0dGV4dC5hcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtc2dhcmVhXCIpO1xyXG5cdHRleHQuc2VuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHh0YXJlYVwiKTtcclxuXHR0ZXh0LnJvb20gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJvb21zXCIpO1xyXG5cdHRleHQudXNlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidXNlcnNcIik7XHJcblxyXG5cdGlmICh3aW5kb3cuaW5uZXJXaWR0aCA8PSA1MDApIHtcclxuXHRcdHRleHQucm9vbS5jbGFzc0xpc3QuYWRkKFwic2hyaW5rXCIpO1xyXG5cdH1cclxuXHJcblx0YXV0aChuaWNrKTtcclxuXHRzZXRDb29raWUoXCJ1c2VyXCIsIG5pY2spO1xyXG5cdHBhcnNlUXVlcmllcygpO1xyXG5cdHJlc2l6ZSgpO1xyXG5cdFxyXG5cdEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcInNjcmlwdCwgbGluaywgaW1nLCBhdWRpbywgaWZyYW1lXCIpKS5mb3JFYWNoKGVsID0+IHtcclxuXHRcdGxldCBhcHAgPSBlbC5zcmMgfHwgZWwuaHJlZjtcclxuXHJcblx0XHRpZiAoYXBwKSB7XHJcblx0XHRcdHdpbmRvdy5oYXMucHVzaChhcHAucmVwbGFjZSgvXmh0dHBzPzpcXC97Mn0uKz9cXC8vZ21pLCAnJykpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdFxyXG5cdHNvY2sub24oXCJtZXNzYWdlXCIsIGFzeW5jIChtc2c6IHN0cmluZywgbmljazogc3RyaW5nLCBybTogc3RyaW5nKTogdm9pZCA9PiB7XHJcblx0XHRpZiAocm0gPT0gcm9vbSkgbWVzc2FnZShtc2csIG5pY2spO1xyXG5cdH0pO1xyXG5cdHNvY2sub24oXCJqb2luYWJsZVwiLCAoY2hhbiwgcGFzcykgPT4ge1xyXG5cdFx0bGV0IGNoYW5uID0gY2hhbjtcclxuXHRcdGlmIChjaGFuIGluIHJvb21zKSB7XHJcblx0XHRcdGxldCBwID0gcm9vbXNbY2hhbl07XHJcblx0XHRcdHAub25jbGljayA9IGZ1bmN0aW9uIGNsaWNrKGU/OiBvYmplY3QpIHtcclxuXHRcdFx0XHRzd2l0Y2hDdXIoY2hhbiwgcGFzcyA/IHVuZGVmaW5lZCA6ICcnKTtcclxuXHRcdFx0fTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0aWYgKGNoYW4uc3RhcnRzV2l0aChcIlVTUlwiKSkge1xyXG5cdFx0XHRjaGFubiA9IGBQcml2YXRlIENoYW5uZWxcXG4gKCR7Y2hhbn0pYDtcclxuXHRcdH1cclxuXHRcdGxldCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XHJcblx0XHRwLmNsYXNzTGlzdC5hZGQoXCJjaGFubmVsXCIpO1xyXG5cdFx0cC5pbm5lckhUTUwgPSBjaGFubjtcclxuXHRcdHAub25jbGljayA9IGZ1bmN0aW9uIGNsaWNrKGU/OiBvYmplY3QpIHtcclxuXHRcdFx0c3dpdGNoQ3VyKGNoYW4sIHBhc3MgPyB1bmRlZmluZWQgOiAnJyk7XHJcblx0XHR9O1xyXG5cdFx0cm9vbXNbY2hhbl0gPSBwO1xyXG5cdFx0dGV4dC5yb29tLmFwcGVuZENoaWxkKHApO1xyXG5cdH0pO1xyXG5cdHNvY2sub24oXCJsZWZ0XCIsICgpID0+IHsgfSk7ICAvL0lNUExcclxuXHRzb2NrLm9uKFwibWFpblwiLCBuYW1lID0+IHtcclxuXHRcdHJvb21zW3Jvb21dLmNsYXNzTGlzdC5yZW1vdmUoXCJzZWxlY3RlZC1jaGFuXCIpO1xyXG5cdFx0cm9vbXNbbmFtZV0uY2xhc3NMaXN0LmFkZChcInNlbGVjdGVkLWNoYW5cIik7XHJcblx0XHRyb29tID0gbmFtZTtcclxuXHR9KTtcclxuXHRzb2NrLm9uKFwiaGlzdG9yeVwiLCBhc3luYyAoLi4uZGF0YTogc3RyaW5nW10pOiB2b2lkID0+IHtcclxuXHRcdGZvciAobGV0IGkgb2YgZGF0YSkge1xyXG5cdFx0XHRpZiAoaS5yb29tID09IHJvb20pIG1lc3NhZ2UoaS5jb250ZW50LCBpLnVzZXIsIChuZXcgRGF0ZShpLnRpbWVzdGFtcCkpLnRvRGF0ZVN0cmluZygpKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHRzb2NrLm9uY2UoXCJjb25uZWN0XCIsICgpOiB2b2lkID0+IHtcclxuXHRcdHRleHQuYXJlYS5pbm5lckhUTUwgPSAnJztcclxuXHRcdG1lc3NhZ2UoXCJUaGlzIGlzIGEgQmV0YSB2ZXJzaW9uIG9mIGEgY2hhdHRpbmcgc2VydmljZSwgdXBjb21pbmcgZmVhdHVyZXMgYXJlOiBwcm9maWxlIHBpY3R1cmUgc3VwcG9ydCwgbXVsdGlwbGUgY2hhdHJvb21zIGFuZCBtb3JlIHNlY3VyaXR5IVwiLCBcIjxmb250IGNvbG9yPSdyZWQnPjxiPlNZU1RFTTwvYj48L2ZvbnQ+XCIpO1xyXG5cdFx0bWVzc2FnZShcIjxiPlRISVMgU0VSVkVSIERPRVMgTk9UIEZPTExPVyBQUklWQUNZIFJVTEVTISEgVVNFIEFUIFlPVVIgT1dOIEFHUkVFTUVOVCAoR0RQUik8L2I+XCIsIFwiPGZvbnQgY29sb3I9J3JlZCc+PGI+U1lTVEVNPC9iPjwvZm9udD5cIik7XHJcblx0XHRtZXNzYWdlKFwiPHU+UGxlYXNlIGJlIGtpbmQgYW5kIGRvbid0IHNwYW0sIHdlIGhhdmUgbWVhbnMgb2YgYmFubmluZyBhZ2dpdGF0b3JzLjwvdT5cIiwgXCI8Zm9udCBjb2xvcj0ncmVkJz48Yj5TWVNURU08L2I+PC9mb250PlwiKTtcclxuXHRcdGNvbnNvbGUuaW5mbyhcIlRoZSBwcmVmaXggaXMgISEsIHR5cGUgISFoZWxwIGluIGNoYXQgZm9yIGNvbW1hbmRzLlwiKTtcclxuXHR9KTtcclxufSAvL2xvYWRcclxuXHJcbmZ1bmN0aW9uIHBhcmV4cChkZWwgPSB0cnVlKSB7XHJcblx0aWYgKGRlbCkge1xyXG5cdFx0cmV0dXJuIHNldFRpbWVvdXQocGFyZXhwLCAzMDAsIGZhbHNlKTtcclxuXHR9XHJcblx0bGV0IGV4cCA9IDYwO1xyXG5cdGlmICh0ZXh0LnJvb20uY2xhc3NMaXN0LmNvbnRhaW5zKFwic2hyaW5rLXJcIikpIHtcclxuXHRcdHRleHQuYXJlYS5jbGFzc0xpc3QuYWRkKFwibXNnYXJlYWxlZnRcIik7XHJcblx0XHRleHAgKz0gMjA7XHJcblx0XHRjb25zb2xlLmluZm8odGV4dC5hcmVhLnN0eWxlLmxlZnQpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHR0ZXh0LmFyZWEuY2xhc3NMaXN0LnJlbW92ZShcIm1zZ2FyZWFsZWZ0XCIpO1xyXG5cdH1cclxuXHRpZiAodGV4dC51c2VyLmNsYXNzTGlzdC5jb250YWlucyhcInNocmluay1sXCIpKSB7XHJcblx0XHRleHAgKz0gMjA7XHJcblx0fVxyXG5cdHJldHVybiB0ZXh0LmFyZWEuc3R5bGUud2lkdGggPSBleHAgKyBcIiVcIjtcclxufSAvL3BhcmV4cFxyXG5cclxuZnVuY3Rpb24gYWxyZWwodGV4dCkge1xyXG5cdGFscmVsID0gKCkgPT4geyB9O1xyXG5cdGFsZXJ0KHRleHQpO1xyXG5cdHJldHVybiBsb2NhdGlvbi5yZWxvYWQoKTtcclxufSAvL2FscmVsXHJcblxyXG5mdW5jdGlvbiBzd2l0Y2hDdXIobmFtZTogc3RyaW5nID0gXCJMT0JCWVwiLCBwYXNzOiBzdHJpbmcgPSBwcm9tcHQoXCJQYXNzd29yZCAoTGVhdmUgZW1wdHkgZm9yIHB1YmxpYyByb29tcyBvciBhbHJlYWR5IGF1dGhvcml6ZWQgcm9vbXMpXCIsICcnKSwgdmlzaWJsZTogYm9vbGVhbiA9IHRydWUpIHtcclxuXHRzb2NrLmVtaXQoXCJzd2l0Y2hcIiwgbmFtZSwgcGFzcywgdmlzaWJsZSk7XHJcblx0cmV0dXJuIHRleHQuYXJlYS5pbm5lckhUTUwgPSAnJztcclxufSAvL3N3aXRjaEN1clxyXG5cclxuZnVuY3Rpb24gc2VuZChtc2c6IHN0cmluZyA9IHRleHQuc2VuZC52YWx1ZSk6IHZvaWQge1xyXG5cdHRleHQuc2VuZC52YWx1ZSA9ICcnO1xyXG5cdGlmIChtc2cuc3RhcnRzV2l0aChwcmVmaXgpKSB7XHJcblx0XHRyZXR1cm4gY29tbWFuZChtc2cpO1xyXG5cdH1cclxuXHRtc2cgPSBtc2cucmVwbGFjZSgvXFwkeygoLnxcXG4pKz8pfS9nbSwgKG1hdGNoLCBwKSA9PiBldmFsKHApKTtcclxuXHRtc2cgPSBtc2cudHJpbSgpO1xyXG5cdHJldHVybiBzZW5kTWVzc2FnZShtc2cpO1xyXG59IC8vc2VuZFxyXG5cclxuZnVuY3Rpb24gc2VuZE1lc3NhZ2UobXNnOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRpZiAoIW1zZykge1xyXG5cdFx0cmV0dXJuIG1lc3NhZ2UoXCI8Zm9udCBjb2xvcj0ncmVkJz48Yj5Zb3UgY2Fubm90IHNlbmQgYW4gZW1wdHkgbWVzc2FnZSE8L2I+PC9mb250PlwiLCBcIjxmb250IGNvbG9yPSdyZWQnPjxiPlNZU1RFTTwvYj48L2ZvbnQ+XCIpO1xyXG5cdH0gZWxzZSBpZiAoRGF0ZS5ub3coKSAtIGxhc3QgPD0gdGhyZXNob2xkKSB7XHJcblx0XHRyZXR1cm4gbWVzc2FnZShgPGZvbnQgY29sb3I9J3JlZCc+PGI+UGxlYXNlIHdhaXQgJHt0aHJlc2hvbGQgLyAxMDAwfXMgYmVmb3JlIHNlbmRpbmcgYW5vdGhlciBtZXNzYWdlITwvYj48L2ZvbnQ+YCwgXCI8Zm9udCBjb2xvcj0ncmVkJz48Yj5TWVNURU08L2I+PC9mb250PlwiKTtcclxuXHR9IGVsc2UgaWYgKGNvbm4pIHtcclxuXHRcdHNvY2suc2VuZChtc2cpO1xyXG5cdFx0cmV0dXJuIGxhc3QgPSBEYXRlLm5vdygpO1xyXG5cdH0gZWxzZSB7XHJcblx0XHRyZXR1cm4gbWVzc2FnZShcIjxmb250IGNvbG9yPSdyZWQnPjxiPllvdSBjYW5ub3Qgc2VuZCBtZXNzYWdlcyB3aGlsZSBkaXNjb25uZWN0ZWQhPC9iPjwvZm9udD5cIiwgXCI8Zm9udCBjb2xvcj0ncmVkJz48Yj5TWVNURU08L2I+PC9mb250PlwiKTtcclxuXHR9XHJcbn0gLy9zZW5kTWVzc2FnZVxyXG5cclxuZnVuY3Rpb24gbWVzc2FnZShtc2c6IHN0cmluZywgdXNlcjogc3RyaW5nLCBkYXRlOiBzdHJpbmcgPSAobmV3IERhdGUoKSkudG9EYXRlU3RyaW5nKCkpOiB2b2lkIHtcclxuXHRsZXQgcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xyXG5cdHAuaW5uZXJIVE1MID0gYDxmb250IGNvbG9yPSdncmF5Jz48c21hbGw+JHtkYXRlfTwvc21hbGw+PC9mb250PiZlbXNwOzxiPiR7dXNlcn06PC9iPiAke21zZ308aHIgLz5gO1xyXG5cdFxyXG5cdHRleHQuYXJlYS5hcHBlbmRDaGlsZChwKTtcclxuXHRpZiAodGV4dC5hcmVhLnNjcm9sbEJ5KSB7XHJcblx0XHRyZXR1cm4gdGV4dC5hcmVhLnNjcm9sbEJ5KDAsIHNjcm9sbCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHJldHVybiB0ZXh0LmFyZWEuc2Nyb2xsVG9wICs9IHNjcm9sbDtcclxuXHR9XHJcbn0gLy9tZXNzYWdlXHJcblxyXG5mdW5jdGlvbiBzaGlmdGNoZWNrKGV2ZW50OiBvYmplY3QsIGRvd246IGJvb2xlYW4gPSB0cnVlKTogdm9pZCB7XHJcblx0aWYgKGV2ZW50LmtleSA9PSBcIlNoaWZ0XCIpIHtcclxuXHRcdHRleHQuc2hpZnQgPSBkb3duO1xyXG5cdH0gZWxzZSBpZiAoZXZlbnQua2V5ID09IFwiQXJyb3dVcFwiICYmIGRvd24pIHtcclxuXHRcdCsraGlzdG9yeUlkeDtcclxuXHRcdGhpc3RvcnlJZHggJT0gaGlzdC5sZW5ndGg7XHJcblx0XHRyZXR1cm4gdGV4dC5zZW5kLnZhbHVlID0gaGlzdFtoaXN0b3J5SWR4XTtcclxuXHR9IGVsc2UgaWYgKGV2ZW50LmtleSA9PSBcIkFycm93VXBcIikge1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoZXZlbnQua2V5ID09IFwiQXJyb3dEb3duXCIgJiYgZG93bikge1xyXG5cdFx0aGlzdG9yeUlkeCA9IChoaXN0b3J5SWR4IDwgMSkgPyAoaGlzdC5sZW5ndGggLSAxKSA6IChoaXN0b3J5SWR4IC0gMSk7XHJcblx0XHRyZXR1cm4gdGV4dC5zZW5kLnZhbHVlID0gaGlzdFtoaXN0b3J5SWR4XTtcclxuXHR9IGVsc2UgaWYgKGV2ZW50LmtleSA9PSBcIkFycm93RG93blwiKSB7XHJcblx0XHRyZXR1cm47XHJcblx0fSBlbHNlIGlmIChldmVudC5rZXkgPT0gXCJFbnRlclwiICYmICF0ZXh0LnNoaWZ0ICYmICFkb3duKSB7XHJcblx0XHRzZW5kKCk7XHJcblx0XHRoaXN0LnVuc2hpZnQoJycpO1xyXG5cdFx0d2hpbGUgKGhpc3QubGVuZ3RoID49IG1heEhpc3RvcnkpIHtcclxuXHRcdFx0aGlzdC5wb3AoKTtcclxuXHRcdH1cclxuXHR9XHJcblx0cmV0dXJuIGhpc3RbMF0gPSB0ZXh0LnNlbmQudmFsdWU7XHJcbn0gLy9zaGlmdGNoZWNrXHJcblxyXG5mdW5jdGlvbiBzdWJtaXQoZT86IG9iamVjdCk6IHZvaWQge1xyXG5cdHRleHQuc2hpZnQgPSBmYWxzZTtcclxuXHRyZXR1cm4gc2hpZnRjaGVjayh7XHJcblx0XHRrZXk6IFwiRW50ZXJcIlxyXG5cdH0sIGZhbHNlKTtcclxufSAvL3N1Ym1pdFxyXG5cclxuZnVuY3Rpb24gc2FuaXRpemUobXNnOiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdG1zZyA9IG1zZy5yZXBsYWNlKC8mL2dtaSwgXCImYW1wO1wiKVxyXG5cdFx0LnJlcGxhY2UoLzwvZ21pLCBcIiZsdDtcIilcclxuXHRcdC5yZXBsYWNlKC8+L2dtaSwgXCImZ3Q7XCIpXHJcblx0XHQucmVwbGFjZSgvXCIvZ21pLCBcIiZxdW90O1wiKVxyXG5cdFx0LnJlcGxhY2UoLycvZ21pLCBcIiYjMDM5O1wiKTtcclxuXHRyZXR1cm4gbXNnO1xyXG59IC8vc2FuaXRpemVcclxuXHJcbmZ1bmN0aW9uIHBhcnNlQ29va2llcyhjb29raWVzOiBzdHJpbmcgPSBkb2N1bWVudC5jb29raWUpOiBNYXAge1xyXG5cdHJldHVybiBuZXcgTWFwKGNvb2tpZXMuc3BsaXQoJzsnKS5tYXAoYyA9PiBjLnNwbGl0KCc9JykpKTtcclxufSAvL3BhcnNlQ29va2llc1xyXG5cclxuZnVuY3Rpb24gc3RvcmVDb29raWVzKG1hcDogTWFwKTogc3RyaW5nIHtcclxuXHRyZXR1cm4gZG9jdW1lbnQuY29va2llID0gQXJyYXkuZnJvbShtYXApLm1hcChhID0+IGEuam9pbignPScpKS5qb2luKCc7Jyk7XHJcbn0gLy9zdG9yZUNvb2tpZXNcclxuXHJcbmZ1bmN0aW9uIHNldENvb2tpZShrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0bGV0IHRtcCA9IHBhcnNlQ29va2llcygpO1xyXG5cdHRtcC5zZXQoa2V5LCB2YWx1ZSk7XHJcblx0cmV0dXJuIHN0b3JlQ29va2llcyh0bXApO1xyXG59IC8vc2V0Q29va2llXHJcblxyXG5mdW5jdGlvbiBnZXRDb29raWUoa2V5OiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdGxldCB0bXA6IE1hcCA9IHBhcnNlQ29va2llcygpO1xyXG5cdHJldHVybiB0bXAuZ2V0KGtleSk7XHJcbn0gLy9nZXRDb29raWVcclxuXHJcbmZ1bmN0aW9uIHBhcnNlUXVlcmllcyhsb2M6IHN0cmluZyA9IGxvY2F0aW9uLmhyZWYpIHtcclxuXHRsZXQgb3V0ID0gbG9jLnNwbGl0KCc/JykucG9wKCkucmVwbGFjZSgvIy4qPyQvLCAnJykuc3BsaXQoJyYnKS5tYXAocSA9PiBxLnNwbGl0KCc9JykpO1xyXG5cclxuXHRmb3IgKGxldCBpIG9mIG91dCkge1xyXG5cdFx0d2luZG93W2kuc2hpZnQoKV0gPSBpLnBvcCgpO1xyXG5cdH1cclxufSAvL3BhcnNlUXVlcmllc1xyXG5cclxud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGxvYWQpO1xyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB3aW5kb3cucmVzaXplID0gZnVuY3Rpb24gcmVzaXplKGUpIHtcclxuXHRsZXQgeHAgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwieHBhbmRcIik7XHJcblx0eHBbMV0uc3R5bGUubGVmdCA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInVpLXdyYXBwZXJcIikub2Zmc2V0V2lkdGggLSB4cFsxXS5vZmZzZXRXaWR0aCAtIHhwWzBdLm9mZnNldExlZnQpICsgXCJweFwiO1xyXG59KTtcclxuIl19