"use strict";var text={shift:!1,area:null,send:null},scroll=100,prefix="!!";for(window.nick=getCookie("user")||"guest_"+Math.round(1e5*Math.random());!(nick=prompt("Insert a Nickname:",nick||getCookie("user")))||!/^[a-zA-Z0-9_\-();' ]+$/i.test(nick););function drop(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;for(a=a.split(" ");b--;)a.shift();return a.join(" ")}//drop
function dropGet(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;for(a=a.split(" ");b--;)a.shift();return a.shift()}//dropGet
function load(){console.log("Index loaded"),text.area=document.getElementById("msgarea"),text.send=document.getElementById("txtarea"),auth(nick),setCookie("user",nick),parseQueries(),sock.on("message",function(a,b){message(a,b)}),sock.once("history",function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];for(var d,e=0;e<b.length;e++)d=b[e],message(d.pop(),d.pop())}),sock.once("connect",function(){text.area.innerHTML="",message("This is a Beta version of a chatting service, upcoming features are: profile picture support, message history view, spam defense, multiple chatrooms and more security!","<font color='red'><b>SYSTEM</b></font>"),message("<u>Please be kind and don't spam, we have means of banning aggitators.</u>","<font color='red'><b>SYSTEM</b></font>"),console.info("The prefix is !!, type !!help in chat for commands.")})}//load
function send(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:text.send.value;return text.send.value="",a.startsWith(prefix)?command(a):void(a=a.trim(),sendMessage(a))}//send
function sendMessage(a){a?conn?sock.send(a):message("<font color='red'><b>You cannot send messages while disconnected!</b></font>","<font color='red'><b>SYSTEM</b></font>"):message("<font color='red'><b>You cannot send an empty message!</b></font>","<font color='red'><b>SYSTEM</b></font>")}//sendMessage
function message(a,b){var c=document.createElement("p");c.innerHTML="<b>".concat(b,":</b> ").concat(a,"<br />"),text.area.appendChild(c),text.area.scrollBy&&text.area.scrollBy(0,scroll)}//message
function shiftcheck(a){var b=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];"Shift"==a.key&&(text.shift=b),"Enter"!=a.key||text.shift||b||send()}//shiftcheck
function submit(){text.shift=!1,shiftcheck({key:"Enter"},!1)}//submit
function sanitize(a){return a=a.replace(/&/gmi,"&amp;").replace(/</gmi,"&lt;").replace(/>/gmi,"&gt;").replace(/"/gmi,"&quot;").replace(/'/gmi,"&#039;"),a}//sanitize
function parseCookies(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:document.cookie;return new Map(a.split(";").map(function(a){return a.split("=")}))}//parseCookies
function storeCookies(a){return document.cookie=Array.from(a).map(function(b){return b.join("=")}).join(";")}//storeCookies
function setCookie(a,b){var c=parseCookies();return c.set(a,b),storeCookies(c)}//setCookie
function getCookie(a){var b=parseCookies();return b.get(a)}//getCookie
function parseQueries(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:location.href,b=a.split("?").pop().replace(/#.*?$/,"").split("&").map(function(a){return a.split("=")}),c=!0,d=!1,e=void 0;try{for(var f,g,h=b[Symbol.iterator]();!(c=(f=h.next()).done);c=!0)g=f.value,window[g.shift()]=g.pop()}catch(a){d=!0,e=a}finally{try{c||null==h.return||h.return()}finally{if(d)throw e}}}//parseQueries
window.addEventListener("DOMContentLoaded",load);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL0pTL2luZGV4LmpzIl0sIm5hbWVzIjpbInRleHQiLCJzaGlmdCIsImFyZWEiLCJzZW5kIiwic2Nyb2xsIiwicHJlZml4Iiwid2luZG93IiwibmljayIsImdldENvb2tpZSIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsInByb21wdCIsInRlc3QiLCJkcm9wIiwibGluZSIsInQiLCJzcGxpdCIsImpvaW4iLCJkcm9wR2V0IiwibG9hZCIsImNvbnNvbGUiLCJsb2ciLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiYXV0aCIsInNldENvb2tpZSIsInBhcnNlUXVlcmllcyIsInNvY2siLCJvbiIsIm1zZyIsIm1lc3NhZ2UiLCJvbmNlIiwiZGF0YSIsImkiLCJwb3AiLCJpbm5lckhUTUwiLCJpbmZvIiwidmFsdWUiLCJzdGFydHNXaXRoIiwiY29tbWFuZCIsInRyaW0iLCJzZW5kTWVzc2FnZSIsImNvbm4iLCJ1c2VyIiwicCIsImNyZWF0ZUVsZW1lbnQiLCJhcHBlbmRDaGlsZCIsInNjcm9sbEJ5Iiwic2hpZnRjaGVjayIsImV2ZW50IiwiZG93biIsImtleSIsInN1Ym1pdCIsInNhbml0aXplIiwicmVwbGFjZSIsInBhcnNlQ29va2llcyIsImNvb2tpZXMiLCJjb29raWUiLCJNYXAiLCJtYXAiLCJjIiwic3RvcmVDb29raWVzIiwiQXJyYXkiLCJmcm9tIiwiYSIsInRtcCIsInNldCIsImdldCIsImxvYyIsImxvY2F0aW9uIiwiaHJlZiIsIm91dCIsInEiLCJhZGRFdmVudExpc3RlbmVyIl0sIm1hcHBpbmdzIjoiQUFBQyxhLEdBRUdBLENBQUFBLElBQVksQ0FBRyxDQUNsQkMsS0FBSyxHQURhLENBRWxCQyxJQUFJLENBQUUsSUFGWSxDQUdsQkMsSUFBSSxDQUFFLElBSFksQyxDQUtsQkMsTUFBTSxDQUFHLEcsQ0FFSkMsTUFBYyxDQUFHLEksS0FFdkJDLE1BQU0sQ0FBQ0MsSUFBUCxDQUFjQyxTQUFTLENBQUMsTUFBRCxDQUFULEVBQXFCLFNBQVdDLElB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QixDQUNBLE1BQU9VLENBQUFBLENBQUcsQ0FBQ0UsR0FBSixDQUFRaEIsQ0FBUixDQUNQLENBQUM7QUFFRixRQUFTekIsQ0FBQUEsWUFBVCxFQUFtRCxJQUE3QjBDLENBQUFBLENBQTZCLHdEQUFmQyxRQUFRLENBQUNDLElBQU0sQ0FDOUNDLENBQUcsQ0FBR0gsQ0FBRyxDQUFDcEQsS0FBSixDQUFVLEdBQVYsRUFBZWtCLEdBQWYsR0FBcUJvQixPQUFyQixDQUE2QixPQUE3QixDQUFzQyxFQUF0QyxFQUEwQ3RDLEtBQTFDLENBQWdELEdBQWhELEVBQXFEMkMsR0FBckQsQ0FBeUQsU0FBQWEsQ0FBQyxRQUFJQSxDQUFBQSxDQUFDLENBQUN4RCxLQUFGLENBQVEsR0FBUixDQUFKLENBQTFELENBRHdDLHdCQUdsRCxVQUFTaUIsQ0FBVCxHQUFjc0MsQ0FBZCxnREFBU3RDLENBQVQsU0FDQzVCLE1BQU0sQ0FBQzRCLENBQUMsQ0FBQ2pDLEtBQUYsRUFBRCxDQUFOLENBQW9CaUMsQ0FBQyxDQUFDQyxHQUFGLEVBSjZCLG1GQU1sRCxDQUFDO0FBRUY3QixNQUFNLENBQUNvRSxnQkFBUCxDQUF3QixrQkFBeEIsQ0FBNEN0RCxJQUE1QyxDIiwic291cmNlc0NvbnRlbnQiOlsi77u/XCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5sZXQgdGV4dDogb2JqZWN0ID0ge1xyXG5cdHNoaWZ0OiBmYWxzZSxcclxuXHRhcmVhOiBudWxsLFxyXG5cdHNlbmQ6IG51bGxcclxufSxcclxuXHRzY3JvbGwgPSAxMDA7XHJcblxyXG5jb25zdCBwcmVmaXg6IHN0cmluZyA9IFwiISFcIjtcclxuXHJcbndpbmRvdy5uaWNrID0gZ2V0Q29va2llKFwidXNlclwiKSB8fCBcImd1ZXN0X1wiICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMWU1KTtcclxuXHJcbndoaWxlICghKG5pY2sgPSBwcm9tcHQoXCJJbnNlcnQgYSBOaWNrbmFtZTpcIiwgbmljayB8fCBnZXRDb29raWUoXCJ1c2VyXCIpKSkgfHwgIS9eW2EtekEtWjAtOV9cXC0oKTsnIF0rJC9pLnRlc3QobmljaykpIHsgfVxyXG5cclxuZnVuY3Rpb24gZHJvcChsaW5lOiBudW1iZXIsIHQ6IG51bWJlciA9IDEpOiBzdHJpbmcge1xyXG5cdGxpbmUgPSBsaW5lLnNwbGl0KCcgJyk7XHJcblx0d2hpbGUgKHQtLSkge1xyXG5cdFx0bGluZS5zaGlmdCgpO1xyXG5cdH1cclxuXHRyZXR1cm4gbGluZS5qb2luKCcgJyk7XHJcbn0gLy9kcm9wXHJcblxyXG5mdW5jdGlvbiBkcm9wR2V0KGxpbmU6IG51bWJlciwgdDogbnVtYmVyID0gMCk6IHN0cmluZyB7XHJcblx0bGluZSA9IGxpbmUuc3BsaXQoJyAnKTtcclxuXHR3aGlsZSAodC0tKSB7XHJcblx0XHRsaW5lLnNoaWZ0KCk7XHJcblx0fVxyXG5cdHJldHVybiBsaW5lLnNoaWZ0KCk7XHJcbn0gLy9kcm9wR2V0XHJcblxyXG5mdW5jdGlvbiBsb2FkKGU/OiBvYmplY3QpOiB2b2lkIHtcclxuXHRjb25zb2xlLmxvZyhcIkluZGV4IGxvYWRlZFwiKTtcclxuXHJcblx0dGV4dC5hcmVhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtc2dhcmVhXCIpO1xyXG5cdHRleHQuc2VuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidHh0YXJlYVwiKTtcclxuXHJcblx0YXV0aChuaWNrKTtcclxuXHRzZXRDb29raWUoXCJ1c2VyXCIsIG5pY2spO1xyXG5cdHBhcnNlUXVlcmllcygpO1xyXG5cdFxyXG5cdHNvY2sub24oXCJtZXNzYWdlXCIsIChtc2c6IHN0cmluZywgbmljazogc3RyaW5nKTogdm9pZCA9PiB7XHJcblx0XHRtZXNzYWdlKG1zZywgbmljayk7XHJcblx0fSk7XHJcblx0c29jay5vbmNlKFwiaGlzdG9yeVwiLCAoLi4uZGF0YTogc3RyaW5nW10pOiB2b2lkID0+IHtcclxuXHRcdGZvciAobGV0IGkgb2YgZGF0YSkge1xyXG5cdFx0XHRtZXNzYWdlKGkucG9wKCksIGkucG9wKCkpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cdHNvY2sub25jZShcImNvbm5lY3RcIiwgKCk6IHZvaWQgPT4ge1xyXG5cdFx0dGV4dC5hcmVhLmlubmVySFRNTCA9ICcnO1xyXG5cdFx0bWVzc2FnZShcIlRoaXMgaXMgYSBCZXRhIHZlcnNpb24gb2YgYSBjaGF0dGluZyBzZXJ2aWNlLCB1cGNvbWluZyBmZWF0dXJlcyBhcmU6IHByb2ZpbGUgcGljdHVyZSBzdXBwb3J0LCBtZXNzYWdlIGhpc3Rvcnkgdmlldywgc3BhbSBkZWZlbnNlLCBtdWx0aXBsZSBjaGF0cm9vbXMgYW5kIG1vcmUgc2VjdXJpdHkhXCIsIFwiPGZvbnQgY29sb3I9J3JlZCc+PGI+U1lTVEVNPC9iPjwvZm9udD5cIik7XHJcblx0XHRtZXNzYWdlKFwiPHU+UGxlYXNlIGJlIGtpbmQgYW5kIGRvbid0IHNwYW0sIHdlIGhhdmUgbWVhbnMgb2YgYmFubmluZyBhZ2dpdGF0b3JzLjwvdT5cIiwgXCI8Zm9udCBjb2xvcj0ncmVkJz48Yj5TWVNURU08L2I+PC9mb250PlwiKTtcclxuXHRcdGNvbnNvbGUuaW5mbyhcIlRoZSBwcmVmaXggaXMgISEsIHR5cGUgISFoZWxwIGluIGNoYXQgZm9yIGNvbW1hbmRzLlwiKTtcclxuXHR9KTtcclxufSAvL2xvYWRcclxuXHJcbmZ1bmN0aW9uIHNlbmQobXNnOiBzdHJpbmcgPSB0ZXh0LnNlbmQudmFsdWUpOiB2b2lkIHtcclxuXHR0ZXh0LnNlbmQudmFsdWUgPSAnJztcclxuXHRpZiAobXNnLnN0YXJ0c1dpdGgocHJlZml4KSkge1xyXG5cdFx0cmV0dXJuIGNvbW1hbmQobXNnKTtcclxuXHR9XHJcblx0bXNnID0gbXNnLnRyaW0oKTtcclxuXHRzZW5kTWVzc2FnZShtc2cpO1xyXG59IC8vc2VuZFxyXG5cclxuZnVuY3Rpb24gc2VuZE1lc3NhZ2UobXNnOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRpZiAoIW1zZykge1xyXG5cdFx0bWVzc2FnZShcIjxmb250IGNvbG9yPSdyZWQnPjxiPllvdSBjYW5ub3Qgc2VuZCBhbiBlbXB0eSBtZXNzYWdlITwvYj48L2ZvbnQ+XCIsIFwiPGZvbnQgY29sb3I9J3JlZCc+PGI+U1lTVEVNPC9iPjwvZm9udD5cIik7XHJcblx0fSBlbHNlIGlmIChjb25uKSB7XHJcblx0XHRzb2NrLnNlbmQobXNnKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0bWVzc2FnZShcIjxmb250IGNvbG9yPSdyZWQnPjxiPllvdSBjYW5ub3Qgc2VuZCBtZXNzYWdlcyB3aGlsZSBkaXNjb25uZWN0ZWQhPC9iPjwvZm9udD5cIiwgXCI8Zm9udCBjb2xvcj0ncmVkJz48Yj5TWVNURU08L2I+PC9mb250PlwiKTtcclxuXHR9XHJcbn0gLy9zZW5kTWVzc2FnZVxyXG5cclxuZnVuY3Rpb24gbWVzc2FnZShtc2c6IHN0cmluZywgdXNlcjogc3RyaW5nKTogdm9pZCB7XHJcblx0bGV0IHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuXHRwLmlubmVySFRNTCA9IGA8Yj4ke3VzZXJ9OjwvYj4gJHttc2d9PGJyIC8+YDtcclxuXHRcclxuXHR0ZXh0LmFyZWEuYXBwZW5kQ2hpbGQocCk7XHJcblx0aWYgKHRleHQuYXJlYS5zY3JvbGxCeSkge1xyXG5cdFx0dGV4dC5hcmVhLnNjcm9sbEJ5KDAsIHNjcm9sbCk7XHJcblx0fVxyXG59IC8vbWVzc2FnZVxyXG5cclxuZnVuY3Rpb24gc2hpZnRjaGVjayhldmVudDogb2JqZWN0LCBkb3duOiBib29sZWFuID0gdHJ1ZSk6IHZvaWQge1xyXG5cdGlmIChldmVudC5rZXkgPT0gXCJTaGlmdFwiKSB7XHJcblx0XHR0ZXh0LnNoaWZ0ID0gZG93bjtcclxuXHR9XHJcblx0aWYgKGV2ZW50LmtleSA9PSBcIkVudGVyXCIgJiYgIXRleHQuc2hpZnQgJiYgIWRvd24pIHtcclxuXHRcdHNlbmQoKTtcclxuXHR9XHJcbn0gLy9zaGlmdGNoZWNrXHJcblxyXG5mdW5jdGlvbiBzdWJtaXQoZT86IG9iamVjdCk6IHZvaWQge1xyXG5cdHRleHQuc2hpZnQgPSBmYWxzZTtcclxuXHRzaGlmdGNoZWNrKHtcclxuXHRcdGtleTogXCJFbnRlclwiXHJcblx0fSwgZmFsc2UpO1xyXG59IC8vc3VibWl0XHJcblxyXG5mdW5jdGlvbiBzYW5pdGl6ZShtc2c6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0bXNnID0gbXNnLnJlcGxhY2UoLyYvZ21pLCBcIiZhbXA7XCIpXHJcblx0XHQucmVwbGFjZSgvPC9nbWksIFwiJmx0O1wiKVxyXG5cdFx0LnJlcGxhY2UoLz4vZ21pLCBcIiZndDtcIilcclxuXHRcdC5yZXBsYWNlKC9cIi9nbWksIFwiJnF1b3Q7XCIpXHJcblx0XHQucmVwbGFjZSgvJy9nbWksIFwiJiMwMzk7XCIpO1xyXG5cdHJldHVybiBtc2c7XHJcbn0gLy9zYW5pdGl6ZVxyXG5cclxuZnVuY3Rpb24gcGFyc2VDb29raWVzKGNvb2tpZXM6IHN0cmluZyA9IGRvY3VtZW50LmNvb2tpZSk6IE1hcCB7XHJcblx0cmV0dXJuIG5ldyBNYXAoY29va2llcy5zcGxpdCgnOycpLm1hcChjID0+IGMuc3BsaXQoJz0nKSkpO1xyXG59IC8vcGFyc2VDb29raWVzXHJcblxyXG5mdW5jdGlvbiBzdG9yZUNvb2tpZXMobWFwOiBNYXApOiBzdHJpbmcge1xyXG5cdHJldHVybiBkb2N1bWVudC5jb29raWUgPSBBcnJheS5mcm9tKG1hcCkubWFwKGEgPT4gYS5qb2luKCc9JykpLmpvaW4oJzsnKTtcclxufSAvL3N0b3JlQ29va2llc1xyXG5cclxuZnVuY3Rpb24gc2V0Q29va2llKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRsZXQgdG1wID0gcGFyc2VDb29raWVzKCk7XHJcblx0dG1wLnNldChrZXksIHZhbHVlKTtcclxuXHRyZXR1cm4gc3RvcmVDb29raWVzKHRtcCk7XHJcbn0gLy9zZXRDb29raWVcclxuXHJcbmZ1bmN0aW9uIGdldENvb2tpZShrZXk6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0bGV0IHRtcDogTWFwID0gcGFyc2VDb29raWVzKCk7XHJcblx0cmV0dXJuIHRtcC5nZXQoa2V5KTtcclxufSAvL2dldENvb2tpZVxyXG5cclxuZnVuY3Rpb24gcGFyc2VRdWVyaWVzKGxvYzogc3RyaW5nID0gbG9jYXRpb24uaHJlZikge1xyXG5cdGxldCBvdXQgPSBsb2Muc3BsaXQoJz8nKS5wb3AoKS5yZXBsYWNlKC8jLio/JC8sICcnKS5zcGxpdCgnJicpLm1hcChxID0+IHEuc3BsaXQoJz0nKSk7XHJcblxyXG5cdGZvciAobGV0IGkgb2Ygb3V0KSB7XHJcblx0XHR3aW5kb3dbaS5zaGlmdCgpXSA9IGkucG9wKCk7XHJcblx0fVxyXG59IC8vcGFyc2VRdWVyaWVzXHJcblxyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgbG9hZCk7XHJcbiJdfQ==