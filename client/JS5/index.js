"use strict";function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){return void c(a)}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){function f(a){asyncGeneratorStep(h,d,e,f,g,"next",a)}function g(a){asyncGeneratorStep(h,d,e,f,g,"throw",a)}var h=a.apply(b,c);f(void 0)})}}var text={area:null,send:null,room:null,user:null},scroll=100,historyIdx=0,hist=[""],maxHistory=50,rooms={},room="LOBBY",last=0,users={},shift=!1,prefix="!!",threshold=800;for(window.has=[],window.nick=getCookie("user")||"guest_"+Math.round(1e5*Math.random());!(nick=prompt("Insert a Nickname:",nick||getCookie("user")))||!/^[a-zA-Z0-9_\-();' ]+$/i.test(nick););function drop(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:1;for(a=a.split(" ");b--;)a.shift();return a.join(" ")}//drop
function dropGet(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0;for(a=a.split(" ");b--;)a.shift();return a.shift()}//dropGet
function load(){return _load.apply(this,arguments)}//load
function _load(){return _load=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:console.log("Index loaded"),text.area=document.getElementById("msgarea"),text.send=document.getElementById("txtarea"),text.room=document.getElementById("rooms"),text.user=document.getElementById("appendUsers"),500>=window.innerWidth&&text.room.classList.add("shrink"),auth(nick),setCookie("user",nick),parseQueries(),resize(),Array.from(document.querySelectorAll("script, link, img, audio, iframe")).forEach(function(a){var b=a.src||a.href;b&&window.has.push(b.replace(/^https?:\/{2}.+?\//gmi,""))}),sock.on("message",/*#__PURE__*/function(){var a=_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(b,c,d){return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:d==room&&message(b,c);case 1:case"end":return a.stop();}},a,this)}));return function(){return a.apply(this,arguments)}}()),sock.on("joinable",function(a,b){var c=a;if(a in rooms){var e=rooms[a];return void(e.onclick=function(){switchCur(a,b?void 0:"")})}a.startsWith("USR")&&(c="Private Channel\n (".concat(a,")"));var d=document.createElement("p");d.classList.add("channel"),d.innerHTML=c,d.onclick=function(){switchCur(a,b?void 0:"")},rooms[a]=d,text.room.appendChild(d)}),sock.on("user",function(a,b){if(!(a in users||b!=room)){var c=document.createElement("p");c.classList.add("user"),c.innerHTML=a,users[a]=c,text.user.appendChild(c)}}),sock.on("userout",function(a){a in users&&(users[a].remove(),delete users[a])}),sock.on("main",function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};rooms[room].classList.remove("selected-chan"),rooms[a].classList.add("selected-chan"),b(room=a)}),sock.on("history",/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/regeneratorRuntime.mark(function a(){var b,c,d,e,f,g=arguments;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:for(b=g.length,c=Array(b),d=0;d<b;d++)c[d]=g[d];for(e=0;e<c.length;e++)f=c[e],f.room==room&&message(f.content,f.user,new Date(f.timestamp).toDateString());case 2:case"end":return a.stop();}},a,this)}))),sock.once("connect",function(){text.area.innerHTML="",message("This is a Beta version of a chatting service, upcoming features are: profile picture support, multiple chatrooms and more security!","<font color='red'><b>SYSTEM</b></font>"),message("<b>THIS SERVER DOES NOT FOLLOW PRIVACY RULES!! USE AT YOUR OWN AGREEMENT (GDPR)</b>","<font color='red'><b>SYSTEM</b></font>"),message("<u>Please be kind and don't spam, we have means of banning aggitators.</u>","<font color='red'><b>SYSTEM</b></font>"),console.info("The prefix is !!, type !!help in chat for commands.")});case 18:case"end":return a.stop();}},a,this)})),_load.apply(this,arguments)}function parexp(){var a=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(a)return setTimeout(parexp,300,!1);var b=60;return text.room.classList.contains("shrink-r")?(text.area.classList.add("msgarealeft"),b+=20,console.info(text.area.style.left)):text.area.classList.remove("msgarealeft"),text.user.parentNode.classList.contains("shrink-l")&&(b+=20),text.area.style.width=b+"%"}//parexp
function alrel(a){return alrel=function(){},alert(a),location.reload()}//alrel
function switchCur(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"LOBBY",b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:prompt("Password (Leave empty for public rooms or already authorized rooms)",""),c=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];return sock.emit("switch",a,b,c),text.user.innerHTML="",users={},text.area.innerHTML=""}//switchCur
function send(){var msg=0<arguments.length&&void 0!==arguments[0]?arguments[0]:text.send.value;return(text.send.value="",msg.startsWith(prefix))?command(msg):(msg=msg.replace(/\${((.|\n)+?)}/gm,function(match,p){return eval(p)}),msg=msg.trim(),sendMessage(msg))}//send
function sendMessage(a){return a?Date.now()-last<=threshold?message("<font color='red'><b>Please wait ".concat(threshold/1e3,"s before sending another message!</b></font>"),"<font color='red'><b>SYSTEM</b></font>"):conn?(sock.send(a),last=Date.now()):message("<font color='red'><b>You cannot send messages while disconnected!</b></font>","<font color='red'><b>SYSTEM</b></font>"):message("<font color='red'><b>You cannot send an empty message!</b></font>","<font color='red'><b>SYSTEM</b></font>")}//sendMessage
function message(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new Date().toDateString(),d=document.createElement("p");return d.innerHTML="<font color='gray'><small>".concat(c,"</small></font>&emsp;<b>").concat(b,":</b> ").concat(a,"<hr />"),text.area.appendChild(d),text.area.scrollBy?text.area.scrollBy(0,scroll):text.area.scrollTop+=scroll}//message
function shiftcheck(a){var b=!(1<arguments.length&&arguments[1]!==void 0)||arguments[1];if("Shift"==a.key)shift=b;else{if("ArrowUp"==a.key&&b)return++historyIdx,historyIdx%=hist.length,text.send.value=hist[historyIdx];if("ArrowUp"==a.key)return;if("ArrowDown"==a.key&&b)return historyIdx=1>historyIdx?hist.length-1:historyIdx-1,text.send.value=hist[historyIdx];if("ArrowDown"==a.key)return;if("Enter"==a.key&&!shift&&!b)for(send(),hist.unshift("");hist.length>=maxHistory;)hist.pop()}return hist[0]=text.send.value}//shiftcheck
function submit(){return shift=!1,shiftcheck({key:"Enter"},!1)}//submit
function sanitize(a){return a=a.replace(/&/gmi,"&amp;").replace(/</gmi,"&lt;").replace(/>/gmi,"&gt;").replace(/"/gmi,"&quot;").replace(/'/gmi,"&#039;"),a}//sanitize
function parseCookies(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:document.cookie;return new Map(a.split(";").map(function(a){return a.split("=")}))}//parseCookies
function storeCookies(a){return document.cookie=Array.from(a).map(function(b){return b.join("=")}).join(";")}//storeCookies
function setCookie(a,b){var c=parseCookies();return c.set(a,b),storeCookies(c)}//setCookie
function getCookie(a){var b=parseCookies();return b.get(a)}//getCookie
function parseQueries(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:location.href,b=a.split("?").pop().replace(/#.*?$/,"").split("&").map(function(a){return a.split("=")}),c=!0,d=!1,e=void 0;try{for(var f,g,h=b[Symbol.iterator]();!(c=(f=h.next()).done);c=!0)g=f.value,window[g.shift()]=g.pop()}catch(a){d=!0,e=a}finally{try{c||null==h.return||h.return()}finally{if(d)throw e}}}//parseQueries
window.addEventListener("DOMContentLoaded",load),window.addEventListener("resize",window.resize=function(){var a=document.getElementsByClassName("xpand");a[1].style.left=document.getElementById("ui-wrapper").offsetWidth-a[1].offsetWidth-a[0].offsetLeft+"px"});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL0pTL2luZGV4LmpzIl0sIm5hbWVzIjpbInRleHQiLCJhcmVhIiwic2VuZCIsInJvb20iLCJ1c2VyIiwic2Nyb2xsIiwiaGlzdG9yeUlkeCIsImhpc3QiLCJtYXhIaXN0b3J5Iiwicm9vbXMiLCJsYXN0IiwidXNlcnMiLCJzaGlmdCIsInByZWZpeCIsInRocmVzaG9sZCIsIndpbmRvdyIsImhhcyIsIm5pY2siLCJnZXRDb29raWUiLCJNYXRoIiwicm91bmQiLCJyYW5kb20iLCJwcm9tcHQiLCJ0ZXN0IiwiZHJvcCIsImxpbmUiLCJ0Iiwic3BsaXQiLCJqb2luIiwiZHJvcEdldCIsImxvYWQiLCJjb25zb2xlIiwibG9nIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVyV2lkdGgiLCJjbGFzc0xpc3QiLCJhZGQiLCJhdXRoIiwic2V0Q29va2llIiwicGFyc2VRdWVyaWVzIiwicmVzaXplIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJlbCIsImFwcCIsInNyYyIsImhyZWYiLCJwdXNoIiwicmVwbGFjZSIsInNvY2siLCJvbiIsIm1zZyIsInJtIiwibWVzc2FnZSIsImNoYW4iLCJwYXNzIiwiY2hhbm4iLCJwIiwib25jbGljayIsInN3aXRjaEN1ciIsInN0YXJ0c1dpdGgiLCJjcmVhdGVFbGVtZW50IiwiaW5uZXJIVE1MIiwiYXBwZW5kQ2hpbGQiLCJyZW1vdmUiLCJuYW1lIiwiZ290IiwiZGF0YSIsImkiLCJjb250ZW50IiwiRGF0ZSIsInRpbWVzdGFtcCIsInRvRGF0ZVN0cmluZyIsIm9uY2UiLCJpbmZvIiwicGFyZXhwIiwiZGVsIiwic2V0VGltZW91dCIsImV4cCIsImNvbnRhaW5zIiwic3R5bGUiLCJsZWZ0IiwicGFyZW50Tm9kZSIsIndpZHRoIiwiYWxyZWwiLCJhbGVydCIsImxvY2F0aW9uIiwicmVsb2FkIiwidmlzaWJsZSIsImVtaXQiLCJ2YWx1ZSIsImNvbW1hbmQiLCJtYXRjaCIsImV2YWwiLCJ0cmltIiwic2VuZE1lc3NhZ2UiLCJub3ciLCJjb25uIiwiZGF0ZSIsInNjcm9sbEJ5Iiwic2Nyb2xsVG9wIiwic2hpZnRjaGVjayIsImV2ZW50IiwiZG93biIsImtleSIsImxlbmd0aCIsInVuc2hpZnQiLCJwb3AiLCJzdWJtaXQiLCJzYW5pdGl6ZSIsInBhcnNlQ29va2llcyIsImNvb2tpZXMiLCJjb29raWUiLCJNYXAiLCJtYXAiLCJjIiwic3RvcmVDb29raWVzIiwiYSIsInRtcCIsInNldCIsImdldCIsImxvYyIsIm91dCIsInEiLCJhZGRFdmVudExpc3RlbmVyIiwieHAiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwib2Zmc2V0V2lkdGgiLCJvZmZzZXRMZWZ0Il0sIm1hcHBpbmdzIjoiQUFBQyxhLGdZQUVHQSxDQUFBQSxJQUFZLENBQUcsQ0FDbEJDLElBQUksQ0FBRSxJQURZLENBRWxCQyxJQUFJLENBQUUsSUFGWSxDQUdsQkMsSUFBSSxDQUFFLElBSFksQ0FJbEJDLElBQUksQ0FBRSxJQUpZLEMsQ0FNbEJDLE1BQWMsQ0FBRyxHLENBQ2pCQyxVQUFrQixDQUFHLEMsQ0FDckJDLElBQVcsQ0FBRyxDQUFFLEVBQUYsQyxDQUNkQyxVQUFrQixDQUFHLEUsQ0FDckJDLEtBQWEsQ0FBRyxFLENBQ2hCTixJQUFZLENBQUcsTyxDQUNmTyxJQUFZLENBQUcsQyxDQUNmQyxLQUFhLENBQUcsRSxDQUNoQkMsS0FBYyxHLENBRVRDLE1BQWMsQ0FBRyxJLENBQ3RCQyxTQUFpQixDQUFHLEcsS0FFckJDLE1BQU0sQ0FBQ0MsR0FBUCxDQUFhLEUsQ0FFYkQsTUFBTSxDQUFDRSxJQUFQLENBQWNDLFNBQVMsQ0FBQyxNQUFELENBQVQsRUFBcUIsU0FBV0MsSUFBSSxDQUFDQyxLQUFMLENBQTJCLEdBQWhCLENBQUFELElBQUksQ0FBQ0UsTUFBTCxFQUFYLEMsQ0FFdkMsRUFBRUosSUFBSSxDQUFHSyxNQUFNLENBQUMsb0JBQUQsQ0FBdUJMLElBQUksRUFBSUMsU0FBUyxDQUFDLE1BQUQsQ0FBeEMsQ0FBZixH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QUFlbUYsR0FBZixHQUFxQjNELE9BQXJCLENBQTZCLE9BQTdCLENBQXNDLEVBQXRDLEVBQTBDeEIsS0FBMUMsQ0FBZ0QsR0FBaEQsRUFBcUQwRixHQUFyRCxDQUF5RCxTQUFBUyxDQUFDLFFBQUlBLENBQUFBLENBQUMsQ0FBQ25HLEtBQUYsQ0FBUSxHQUFSLENBQUosQ0FBMUQsQ0FEOEMsd0JBR3hELFVBQVM0QyxDQUFULEdBQWNzRCxDQUFkLGdEQUFTdEQsQ0FBVCxTQUNDeEQsTUFBTSxDQUFDd0QsQ0FBQyxDQUFDM0QsS0FBRixFQUFELENBQU4sQ0FBb0IyRCxDQUFDLENBQUN1QyxHQUFGLEVBSm1DLG1GQU14RCxDQUFDO0FBRUYvRixNQUFNLENBQUNnSCxnQkFBUCxDQUF3QixrQkFBeEIsQ0FBNENqRyxJQUE1QyxDLENBQ0FmLE1BQU0sQ0FBQ2dILGdCQUFQLENBQXdCLFFBQXhCLENBQWtDaEgsTUFBTSxDQUFDMEIsTUFBUCxDQUFnQixVQUFrQyxDQUNuRixHQUFJdUYsQ0FBQUEsQ0FBRSxDQUFHL0YsUUFBUSxDQUFDZ0csc0JBQVQsQ0FBZ0MsT0FBaEMsQ0FBVCxDQUNBRCxDQUFFLENBQUMsQ0FBRCxDQUFGLENBQU03QyxLQUFOLENBQVlDLElBQVosQ0FBb0JuRCxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsWUFBeEIsRUFBc0NnRyxXQUF0QyxDQUFvREYsQ0FBRSxDQUFDLENBQUQsQ0FBRixDQUFNRSxXQUExRCxDQUF3RUYsQ0FBRSxDQUFDLENBQUQsQ0FBRixDQUFNRyxVQUEvRSxDQUE2RixJQUNoSCxDQUhELEMiLCJzb3VyY2VzQ29udGVudCI6WyLvu79cInVzZSBzdHJpY3RcIjtcclxuXHJcbmxldCB0ZXh0OiBvYmplY3QgPSB7XHJcblx0YXJlYTogbnVsbCxcclxuXHRzZW5kOiBudWxsLFxyXG5cdHJvb206IG51bGwsXHJcblx0dXNlcjogbnVsbFxyXG59LFxyXG5cdHNjcm9sbDogbnVtYmVyID0gMTAwLFxyXG5cdGhpc3RvcnlJZHg6IG51bWJlciA9IDAsXHJcblx0aGlzdDogQXJyYXkgPSBbICcnIF0sXHJcblx0bWF4SGlzdG9yeTogbnVtYmVyID0gNTAsXHJcblx0cm9vbXM6IG9iamVjdCA9IHsgfSxcclxuXHRyb29tOiBzdHJpbmcgPSBcIkxPQkJZXCIsXHJcblx0bGFzdDogbnVtYmVyID0gMCxcclxuXHR1c2Vyczogb2JqZWN0ID0geyB9LFxyXG5cdHNoaWZ0OiBib29sZWFuID0gZmFsc2U7XHJcblxyXG5jb25zdCBwcmVmaXg6IHN0cmluZyA9IFwiISFcIixcclxuXHR0aHJlc2hvbGQ6IG51bWJlciA9IDgwMDtcclxuXHJcbndpbmRvdy5oYXMgPSBbIF07XHJcblxyXG53aW5kb3cubmljayA9IGdldENvb2tpZShcInVzZXJcIikgfHwgXCJndWVzdF9cIiArIE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIDFlNSk7XHJcblxyXG53aGlsZSAoIShuaWNrID0gcHJvbXB0KFwiSW5zZXJ0IGEgTmlja25hbWU6XCIsIG5pY2sgfHwgZ2V0Q29va2llKFwidXNlclwiKSkpIHx8ICEvXlthLXpBLVowLTlfXFwtKCk7JyBdKyQvaS50ZXN0KG5pY2spKSB7IH1cclxuXHJcbmZ1bmN0aW9uIGRyb3AobGluZTogbnVtYmVyLCB0OiBudW1iZXIgPSAxKTogc3RyaW5nIHtcclxuXHRsaW5lID0gbGluZS5zcGxpdCgnICcpO1xyXG5cdHdoaWxlICh0LS0pIHtcclxuXHRcdGxpbmUuc2hpZnQoKTtcclxuXHR9XHJcblx0cmV0dXJuIGxpbmUuam9pbignICcpO1xyXG59IC8vZHJvcFxyXG5cclxuZnVuY3Rpb24gZHJvcEdldChsaW5lOiBudW1iZXIsIHQ6IG51bWJlciA9IDApOiBzdHJpbmcge1xyXG5cdGxpbmUgPSBsaW5lLnNwbGl0KCcgJyk7XHJcblx0d2hpbGUgKHQtLSkge1xyXG5cdFx0bGluZS5zaGlmdCgpO1xyXG5cdH1cclxuXHRyZXR1cm4gbGluZS5zaGlmdCgpO1xyXG59IC8vZHJvcEdldFxyXG5cclxuYXN5bmMgZnVuY3Rpb24gbG9hZChlPzogb2JqZWN0KTogdm9pZCB7XHJcblx0Y29uc29sZS5sb2coXCJJbmRleCBsb2FkZWRcIik7XHJcblxyXG5cdHRleHQuYXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibXNnYXJlYVwiKTtcclxuXHR0ZXh0LnNlbmQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInR4dGFyZWFcIik7XHJcblx0dGV4dC5yb29tID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyb29tc1wiKTtcclxuXHR0ZXh0LnVzZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFwcGVuZFVzZXJzXCIpO1xyXG5cclxuXHRpZiAod2luZG93LmlubmVyV2lkdGggPD0gNTAwKSB7XHJcblx0XHR0ZXh0LnJvb20uY2xhc3NMaXN0LmFkZChcInNocmlua1wiKTtcclxuXHR9XHJcblxyXG5cdGF1dGgobmljayk7XHJcblx0c2V0Q29va2llKFwidXNlclwiLCBuaWNrKTtcclxuXHRwYXJzZVF1ZXJpZXMoKTtcclxuXHRyZXNpemUoKTtcclxuXHRcclxuXHRBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJzY3JpcHQsIGxpbmssIGltZywgYXVkaW8sIGlmcmFtZVwiKSkuZm9yRWFjaChlbCA9PiB7XHJcblx0XHRsZXQgYXBwID0gZWwuc3JjIHx8IGVsLmhyZWY7XHJcblxyXG5cdFx0aWYgKGFwcCkge1xyXG5cdFx0XHR3aW5kb3cuaGFzLnB1c2goYXBwLnJlcGxhY2UoL15odHRwcz86XFwvezJ9Lis/XFwvL2dtaSwgJycpKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHRcclxuXHRzb2NrLm9uKFwibWVzc2FnZVwiLCBhc3luYyAobXNnOiBzdHJpbmcsIG5pY2s6IHN0cmluZywgcm06IHN0cmluZyk6IHZvaWQgPT4ge1xyXG5cdFx0aWYgKHJtID09IHJvb20pIG1lc3NhZ2UobXNnLCBuaWNrKTtcclxuXHR9KTtcclxuXHRzb2NrLm9uKFwiam9pbmFibGVcIiwgKGNoYW46IHN0cmluZywgcGFzczogc3RyaW5nKTogdm9pZCA9PiB7XHJcblx0XHRsZXQgY2hhbm4gPSBjaGFuO1xyXG5cdFx0aWYgKGNoYW4gaW4gcm9vbXMpIHtcclxuXHRcdFx0bGV0IHAgPSByb29tc1tjaGFuXTtcclxuXHRcdFx0cC5vbmNsaWNrID0gZnVuY3Rpb24gY2xpY2soZT86IG9iamVjdCkge1xyXG5cdFx0XHRcdHN3aXRjaEN1cihjaGFuLCBwYXNzID8gdW5kZWZpbmVkIDogJycpO1xyXG5cdFx0XHR9O1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRpZiAoY2hhbi5zdGFydHNXaXRoKFwiVVNSXCIpKSB7XHJcblx0XHRcdGNoYW5uID0gYFByaXZhdGUgQ2hhbm5lbFxcbiAoJHtjaGFufSlgO1xyXG5cdFx0fVxyXG5cdFx0bGV0IHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuXHRcdHAuY2xhc3NMaXN0LmFkZChcImNoYW5uZWxcIik7XHJcblx0XHRwLmlubmVySFRNTCA9IGNoYW5uO1xyXG5cdFx0cC5vbmNsaWNrID0gZnVuY3Rpb24gY2xpY2soZT86IG9iamVjdCk6IHZvaWQge1xyXG5cdFx0XHRzd2l0Y2hDdXIoY2hhbiwgcGFzcyA/IHVuZGVmaW5lZCA6ICcnKTtcclxuXHRcdH07XHJcblx0XHRyb29tc1tjaGFuXSA9IHA7XHJcblx0XHR0ZXh0LnJvb20uYXBwZW5kQ2hpbGQocCk7XHJcblx0fSk7XHJcblx0c29jay5vbihcInVzZXJcIiwgKG5pY2s6IHN0cmluZywgY2hhbjogc3RyaW5nKTogdm9pZCA9PiB7XHJcblx0XHRpZiAoKG5pY2sgaW4gdXNlcnMpIHx8IGNoYW4gIT0gcm9vbSkgcmV0dXJuO1xyXG5cdFx0bGV0IHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuXHRcdHAuY2xhc3NMaXN0LmFkZChcInVzZXJcIik7XHJcblx0XHRwLmlubmVySFRNTCA9IG5pY2s7XHJcblx0XHR1c2Vyc1tuaWNrXSA9IHA7XHJcblx0XHR0ZXh0LnVzZXIuYXBwZW5kQ2hpbGQocCk7XHJcblx0fSk7XHJcblx0c29jay5vbihcInVzZXJvdXRcIiwgKG5pY2s6IHN0cmluZyk6IHZvaWQgPT4ge1xyXG5cdFx0aWYgKG5pY2sgaW4gdXNlcnMpIHtcclxuXHRcdFx0dXNlcnNbbmlja10ucmVtb3ZlKCk7XHJcblx0XHRcdGRlbGV0ZSB1c2Vyc1tuaWNrXTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHRzb2NrLm9uKFwibWFpblwiLCAobmFtZTogc3RyaW5nLCBnb3Q6IEZ1bmN0aW9uID0gKCk6IHZvaWQgPT4geyB9KTogdm9pZCA9PiB7XHJcblx0XHRyb29tc1tyb29tXS5jbGFzc0xpc3QucmVtb3ZlKFwic2VsZWN0ZWQtY2hhblwiKTtcclxuXHRcdHJvb21zW25hbWVdLmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RlZC1jaGFuXCIpO1xyXG5cdFx0Z290KHJvb20gPSBuYW1lKTtcclxuXHR9KTtcclxuXHRzb2NrLm9uKFwiaGlzdG9yeVwiLCBhc3luYyAoLi4uZGF0YTogc3RyaW5nW10pOiB2b2lkID0+IHtcclxuXHRcdGZvciAobGV0IGkgb2YgZGF0YSkge1xyXG5cdFx0XHRpZiAoaS5yb29tID09IHJvb20pIG1lc3NhZ2UoaS5jb250ZW50LCBpLnVzZXIsIChuZXcgRGF0ZShpLnRpbWVzdGFtcCkpLnRvRGF0ZVN0cmluZygpKTtcclxuXHRcdH1cclxuXHR9KTtcclxuXHRzb2NrLm9uY2UoXCJjb25uZWN0XCIsICgpOiB2b2lkID0+IHtcclxuXHRcdHRleHQuYXJlYS5pbm5lckhUTUwgPSAnJztcclxuXHRcdG1lc3NhZ2UoXCJUaGlzIGlzIGEgQmV0YSB2ZXJzaW9uIG9mIGEgY2hhdHRpbmcgc2VydmljZSwgdXBjb21pbmcgZmVhdHVyZXMgYXJlOiBwcm9maWxlIHBpY3R1cmUgc3VwcG9ydCwgbXVsdGlwbGUgY2hhdHJvb21zIGFuZCBtb3JlIHNlY3VyaXR5IVwiLCBcIjxmb250IGNvbG9yPSdyZWQnPjxiPlNZU1RFTTwvYj48L2ZvbnQ+XCIpO1xyXG5cdFx0bWVzc2FnZShcIjxiPlRISVMgU0VSVkVSIERPRVMgTk9UIEZPTExPVyBQUklWQUNZIFJVTEVTISEgVVNFIEFUIFlPVVIgT1dOIEFHUkVFTUVOVCAoR0RQUik8L2I+XCIsIFwiPGZvbnQgY29sb3I9J3JlZCc+PGI+U1lTVEVNPC9iPjwvZm9udD5cIik7XHJcblx0XHRtZXNzYWdlKFwiPHU+UGxlYXNlIGJlIGtpbmQgYW5kIGRvbid0IHNwYW0sIHdlIGhhdmUgbWVhbnMgb2YgYmFubmluZyBhZ2dpdGF0b3JzLjwvdT5cIiwgXCI8Zm9udCBjb2xvcj0ncmVkJz48Yj5TWVNURU08L2I+PC9mb250PlwiKTtcclxuXHRcdGNvbnNvbGUuaW5mbyhcIlRoZSBwcmVmaXggaXMgISEsIHR5cGUgISFoZWxwIGluIGNoYXQgZm9yIGNvbW1hbmRzLlwiKTtcclxuXHR9KTtcclxufSAvL2xvYWRcclxuXHJcbmZ1bmN0aW9uIHBhcmV4cChkZWw6IGJvb2xlYW4gPSB0cnVlKTogYW55IHtcclxuXHRpZiAoZGVsKSB7XHJcblx0XHRyZXR1cm4gc2V0VGltZW91dChwYXJleHAsIDMwMCwgZmFsc2UpO1xyXG5cdH1cclxuXHRsZXQgZXhwID0gNjA7XHJcblx0aWYgKHRleHQucm9vbS5jbGFzc0xpc3QuY29udGFpbnMoXCJzaHJpbmstclwiKSkge1xyXG5cdFx0dGV4dC5hcmVhLmNsYXNzTGlzdC5hZGQoXCJtc2dhcmVhbGVmdFwiKTtcclxuXHRcdGV4cCArPSAyMDtcclxuXHRcdGNvbnNvbGUuaW5mbyh0ZXh0LmFyZWEuc3R5bGUubGVmdCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHRleHQuYXJlYS5jbGFzc0xpc3QucmVtb3ZlKFwibXNnYXJlYWxlZnRcIik7XHJcblx0fVxyXG5cdGlmICh0ZXh0LnVzZXIucGFyZW50Tm9kZS5jbGFzc0xpc3QuY29udGFpbnMoXCJzaHJpbmstbFwiKSkge1xyXG5cdFx0ZXhwICs9IDIwO1xyXG5cdH1cclxuXHRyZXR1cm4gdGV4dC5hcmVhLnN0eWxlLndpZHRoID0gZXhwICsgXCIlXCI7XHJcbn0gLy9wYXJleHBcclxuXHJcbmZ1bmN0aW9uIGFscmVsKHRleHQ6IHN0cmluZyk6IGFueSB7XHJcblx0YWxyZWwgPSAoKSA9PiB7IH07XHJcblx0YWxlcnQodGV4dCk7XHJcblx0cmV0dXJuIGxvY2F0aW9uLnJlbG9hZCgpO1xyXG59IC8vYWxyZWxcclxuXHJcbmZ1bmN0aW9uIHN3aXRjaEN1cihuYW1lOiBzdHJpbmcgPSBcIkxPQkJZXCIsIHBhc3M6IHN0cmluZyA9IHByb21wdChcIlBhc3N3b3JkIChMZWF2ZSBlbXB0eSBmb3IgcHVibGljIHJvb21zIG9yIGFscmVhZHkgYXV0aG9yaXplZCByb29tcylcIiwgJycpLCB2aXNpYmxlOiBib29sZWFuID0gdHJ1ZSk6IHN0cmluZyB7XHJcblx0c29jay5lbWl0KFwic3dpdGNoXCIsIG5hbWUsIHBhc3MsIHZpc2libGUpO1xyXG5cdHRleHQudXNlci5pbm5lckhUTUwgPSAnJztcclxuXHR1c2VycyA9IHsgfTtcclxuXHRyZXR1cm4gdGV4dC5hcmVhLmlubmVySFRNTCA9ICcnO1xyXG59IC8vc3dpdGNoQ3VyXHJcblxyXG5mdW5jdGlvbiBzZW5kKG1zZzogc3RyaW5nID0gdGV4dC5zZW5kLnZhbHVlKTogdm9pZCB7XHJcblx0dGV4dC5zZW5kLnZhbHVlID0gJyc7XHJcblx0aWYgKG1zZy5zdGFydHNXaXRoKHByZWZpeCkpIHtcclxuXHRcdHJldHVybiBjb21tYW5kKG1zZyk7XHJcblx0fVxyXG5cdG1zZyA9IG1zZy5yZXBsYWNlKC9cXCR7KCgufFxcbikrPyl9L2dtLCAobWF0Y2gsIHApID0+IGV2YWwocCkpO1xyXG5cdG1zZyA9IG1zZy50cmltKCk7XHJcblx0cmV0dXJuIHNlbmRNZXNzYWdlKG1zZyk7XHJcbn0gLy9zZW5kXHJcblxyXG5mdW5jdGlvbiBzZW5kTWVzc2FnZShtc2c6IHN0cmluZyk6IHZvaWQge1xyXG5cdGlmICghbXNnKSB7XHJcblx0XHRyZXR1cm4gbWVzc2FnZShcIjxmb250IGNvbG9yPSdyZWQnPjxiPllvdSBjYW5ub3Qgc2VuZCBhbiBlbXB0eSBtZXNzYWdlITwvYj48L2ZvbnQ+XCIsIFwiPGZvbnQgY29sb3I9J3JlZCc+PGI+U1lTVEVNPC9iPjwvZm9udD5cIik7XHJcblx0fSBlbHNlIGlmIChEYXRlLm5vdygpIC0gbGFzdCA8PSB0aHJlc2hvbGQpIHtcclxuXHRcdHJldHVybiBtZXNzYWdlKGA8Zm9udCBjb2xvcj0ncmVkJz48Yj5QbGVhc2Ugd2FpdCAke3RocmVzaG9sZCAvIDEwMDB9cyBiZWZvcmUgc2VuZGluZyBhbm90aGVyIG1lc3NhZ2UhPC9iPjwvZm9udD5gLCBcIjxmb250IGNvbG9yPSdyZWQnPjxiPlNZU1RFTTwvYj48L2ZvbnQ+XCIpO1xyXG5cdH0gZWxzZSBpZiAoY29ubikge1xyXG5cdFx0c29jay5zZW5kKG1zZyk7XHJcblx0XHRyZXR1cm4gbGFzdCA9IERhdGUubm93KCk7XHJcblx0fSBlbHNlIHtcclxuXHRcdHJldHVybiBtZXNzYWdlKFwiPGZvbnQgY29sb3I9J3JlZCc+PGI+WW91IGNhbm5vdCBzZW5kIG1lc3NhZ2VzIHdoaWxlIGRpc2Nvbm5lY3RlZCE8L2I+PC9mb250PlwiLCBcIjxmb250IGNvbG9yPSdyZWQnPjxiPlNZU1RFTTwvYj48L2ZvbnQ+XCIpO1xyXG5cdH1cclxufSAvL3NlbmRNZXNzYWdlXHJcblxyXG5mdW5jdGlvbiBtZXNzYWdlKG1zZzogc3RyaW5nLCB1c2VyOiBzdHJpbmcsIGRhdGU6IHN0cmluZyA9IChuZXcgRGF0ZSgpKS50b0RhdGVTdHJpbmcoKSk6IHZvaWQge1xyXG5cdGxldCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XHJcblx0cC5pbm5lckhUTUwgPSBgPGZvbnQgY29sb3I9J2dyYXknPjxzbWFsbD4ke2RhdGV9PC9zbWFsbD48L2ZvbnQ+JmVtc3A7PGI+JHt1c2VyfTo8L2I+ICR7bXNnfTxociAvPmA7XHJcblx0XHJcblx0dGV4dC5hcmVhLmFwcGVuZENoaWxkKHApO1xyXG5cdGlmICh0ZXh0LmFyZWEuc2Nyb2xsQnkpIHtcclxuXHRcdHJldHVybiB0ZXh0LmFyZWEuc2Nyb2xsQnkoMCwgc2Nyb2xsKTtcclxuXHR9IGVsc2Uge1xyXG5cdFx0cmV0dXJuIHRleHQuYXJlYS5zY3JvbGxUb3AgKz0gc2Nyb2xsO1xyXG5cdH1cclxufSAvL21lc3NhZ2VcclxuXHJcbmZ1bmN0aW9uIHNoaWZ0Y2hlY2soZXZlbnQ6IG9iamVjdCwgZG93bjogYm9vbGVhbiA9IHRydWUpOiB2b2lkIHtcclxuXHRpZiAoZXZlbnQua2V5ID09IFwiU2hpZnRcIikge1xyXG5cdFx0c2hpZnQgPSBkb3duO1xyXG5cdH0gZWxzZSBpZiAoZXZlbnQua2V5ID09IFwiQXJyb3dVcFwiICYmIGRvd24pIHtcclxuXHRcdCsraGlzdG9yeUlkeDtcclxuXHRcdGhpc3RvcnlJZHggJT0gaGlzdC5sZW5ndGg7XHJcblx0XHRyZXR1cm4gdGV4dC5zZW5kLnZhbHVlID0gaGlzdFtoaXN0b3J5SWR4XTtcclxuXHR9IGVsc2UgaWYgKGV2ZW50LmtleSA9PSBcIkFycm93VXBcIikge1xyXG5cdFx0cmV0dXJuO1xyXG5cdH0gZWxzZSBpZiAoZXZlbnQua2V5ID09IFwiQXJyb3dEb3duXCIgJiYgZG93bikge1xyXG5cdFx0aGlzdG9yeUlkeCA9IChoaXN0b3J5SWR4IDwgMSkgPyAoaGlzdC5sZW5ndGggLSAxKSA6IChoaXN0b3J5SWR4IC0gMSk7XHJcblx0XHRyZXR1cm4gdGV4dC5zZW5kLnZhbHVlID0gaGlzdFtoaXN0b3J5SWR4XTtcclxuXHR9IGVsc2UgaWYgKGV2ZW50LmtleSA9PSBcIkFycm93RG93blwiKSB7XHJcblx0XHRyZXR1cm47XHJcblx0fSBlbHNlIGlmIChldmVudC5rZXkgPT0gXCJFbnRlclwiICYmICFzaGlmdCAmJiAhZG93bikge1xyXG5cdFx0c2VuZCgpO1xyXG5cdFx0aGlzdC51bnNoaWZ0KCcnKTtcclxuXHRcdHdoaWxlIChoaXN0Lmxlbmd0aCA+PSBtYXhIaXN0b3J5KSB7XHJcblx0XHRcdGhpc3QucG9wKCk7XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiBoaXN0WzBdID0gdGV4dC5zZW5kLnZhbHVlO1xyXG59IC8vc2hpZnRjaGVja1xyXG5cclxuZnVuY3Rpb24gc3VibWl0KGU/OiBvYmplY3QpOiB2b2lkIHtcclxuXHRzaGlmdCA9IGZhbHNlO1xyXG5cdHJldHVybiBzaGlmdGNoZWNrKHtcclxuXHRcdGtleTogXCJFbnRlclwiXHJcblx0fSwgZmFsc2UpO1xyXG59IC8vc3VibWl0XHJcblxyXG5mdW5jdGlvbiBzYW5pdGl6ZShtc2c6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0bXNnID0gbXNnLnJlcGxhY2UoLyYvZ21pLCBcIiZhbXA7XCIpXHJcblx0XHQucmVwbGFjZSgvPC9nbWksIFwiJmx0O1wiKVxyXG5cdFx0LnJlcGxhY2UoLz4vZ21pLCBcIiZndDtcIilcclxuXHRcdC5yZXBsYWNlKC9cIi9nbWksIFwiJnF1b3Q7XCIpXHJcblx0XHQucmVwbGFjZSgvJy9nbWksIFwiJiMwMzk7XCIpO1xyXG5cdHJldHVybiBtc2c7XHJcbn0gLy9zYW5pdGl6ZVxyXG5cclxuZnVuY3Rpb24gcGFyc2VDb29raWVzKGNvb2tpZXM6IHN0cmluZyA9IGRvY3VtZW50LmNvb2tpZSk6IE1hcCB7XHJcblx0cmV0dXJuIG5ldyBNYXAoY29va2llcy5zcGxpdCgnOycpLm1hcChjID0+IGMuc3BsaXQoJz0nKSkpO1xyXG59IC8vcGFyc2VDb29raWVzXHJcblxyXG5mdW5jdGlvbiBzdG9yZUNvb2tpZXMobWFwOiBNYXApOiBzdHJpbmcge1xyXG5cdHJldHVybiBkb2N1bWVudC5jb29raWUgPSBBcnJheS5mcm9tKG1hcCkubWFwKGEgPT4gYS5qb2luKCc9JykpLmpvaW4oJzsnKTtcclxufSAvL3N0b3JlQ29va2llc1xyXG5cclxuZnVuY3Rpb24gc2V0Q29va2llKGtleTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRsZXQgdG1wID0gcGFyc2VDb29raWVzKCk7XHJcblx0dG1wLnNldChrZXksIHZhbHVlKTtcclxuXHRyZXR1cm4gc3RvcmVDb29raWVzKHRtcCk7XHJcbn0gLy9zZXRDb29raWVcclxuXHJcbmZ1bmN0aW9uIGdldENvb2tpZShrZXk6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0bGV0IHRtcDogTWFwID0gcGFyc2VDb29raWVzKCk7XHJcblx0cmV0dXJuIHRtcC5nZXQoa2V5KTtcclxufSAvL2dldENvb2tpZVxyXG5cclxuZnVuY3Rpb24gcGFyc2VRdWVyaWVzKGxvYzogc3RyaW5nID0gbG9jYXRpb24uaHJlZik6IHZvaWQge1xyXG5cdGxldCBvdXQgPSBsb2Muc3BsaXQoJz8nKS5wb3AoKS5yZXBsYWNlKC8jLio/JC8sICcnKS5zcGxpdCgnJicpLm1hcChxID0+IHEuc3BsaXQoJz0nKSk7XHJcblxyXG5cdGZvciAobGV0IGkgb2Ygb3V0KSB7XHJcblx0XHR3aW5kb3dbaS5zaGlmdCgpXSA9IGkucG9wKCk7XHJcblx0fVxyXG59IC8vcGFyc2VRdWVyaWVzXHJcblxyXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgbG9hZCk7XHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHdpbmRvdy5yZXNpemUgPSBmdW5jdGlvbiByZXNpemUoZT86IG9iamVjdCk6IHZvaWQge1xyXG5cdGxldCB4cCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ4cGFuZFwiKTtcclxuXHR4cFsxXS5zdHlsZS5sZWZ0ID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidWktd3JhcHBlclwiKS5vZmZzZXRXaWR0aCAtIHhwWzFdLm9mZnNldFdpZHRoIC0geHBbMF0ub2Zmc2V0TGVmdCkgKyBcInB4XCI7XHJcbn0pO1xyXG4iXX0=